<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>统计分析 | Cookbook for R 中文版</title>
  <meta name="description" content="统计分析 | Cookbook for R 中文版本">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="统计分析 | Cookbook for R 中文版" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="统计分析 | Cookbook for R 中文版本" />
  <meta name="github-repo" content="openbiox/Cookbook-for-R-Chinese" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="统计分析 | Cookbook for R 中文版" />
  
  <meta name="twitter:description" content="统计分析 | Cookbook for R 中文版本" />
  

<meta name="author" content="Winston Chang（著）">
<meta name="author" content="王诗翔 等（译）">


<meta name="date" content="2019-04-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="e6938de4bd9ce695b0e68dae.html">
<link rel="next" href="e59bbee5bda2.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Cook book for R 中文版</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>欢迎</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html"><i class="fa fa-check"></i>基础</a><ul>
<li class="chapter" data-level="0.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.1</b> 安装和使用R包</a><ul>
<li class="chapter" data-level="0.1.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.1.1"><i class="fa fa-check"></i><b>0.1.1</b> 问题</a></li>
<li class="chapter" data-level="0.1.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.1.2"><i class="fa fa-check"></i><b>0.1.2</b> 方案</a></li>
<li class="chapter" data-level="0.1.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.1.3"><i class="fa fa-check"></i><b>0.1.3</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.2"><i class="fa fa-check"></i><b>0.2</b> 数据结构的索引</a><ul>
<li class="chapter" data-level="0.2.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.2.1</b> 问题</a></li>
<li class="chapter" data-level="0.2.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.2.2"><i class="fa fa-check"></i><b>0.2.2</b> 解决</a></li>
</ul></li>
<li class="chapter" data-level="0.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.3"><i class="fa fa-check"></i><b>0.3</b> 获取数据结构的子集</a><ul>
<li class="chapter" data-level="0.3.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.3.1</b> 问题</a></li>
<li class="chapter" data-level="0.3.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.3.2</b> 方案</a></li>
<li class="chapter" data-level="0.3.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.3.3"><i class="fa fa-check"></i><b>0.3.3</b> 数据框</a></li>
</ul></li>
<li class="chapter" data-level="0.4" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.4"><i class="fa fa-check"></i><b>0.4</b> 创建填满值的向量</a><ul>
<li class="chapter" data-level="0.4.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-3"><i class="fa fa-check"></i><b>0.4.1</b> 问题</a></li>
<li class="chapter" data-level="0.4.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.4.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#section-0.5"><i class="fa fa-check"></i><b>0.5</b> 获取变量信息</a><ul>
<li class="chapter" data-level="0.5.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-4"><i class="fa fa-check"></i><b>0.5.1</b> 问题</a></li>
<li class="chapter" data-level="0.5.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-3"><i class="fa fa-check"></i><b>0.5.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.6" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#null-na-nan"><i class="fa fa-check"></i><b>0.6</b> NULL-NA-NaN的处理</a><ul>
<li class="chapter" data-level="0.6.1" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-5"><i class="fa fa-check"></i><b>0.6.1</b> 问题</a></li>
<li class="chapter" data-level="0.6.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-4"><i class="fa fa-check"></i><b>0.6.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html"><i class="fa fa-check"></i>数字</a><ul>
<li class="chapter" data-level="0.7" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#section-0.7"><i class="fa fa-check"></i><b>0.7</b> 生成随机数</a><ul>
<li class="chapter" data-level="0.7.1" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-6"><i class="fa fa-check"></i><b>0.7.1</b> 问题</a></li>
<li class="chapter" data-level="0.7.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-5"><i class="fa fa-check"></i><b>0.7.2</b> 方案</a></li>
<li class="chapter" data-level="0.7.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-3"><i class="fa fa-check"></i><b>0.7.3</b> 注意</a></li>
</ul></li>
<li class="chapter" data-level="0.8" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#section-0.8"><i class="fa fa-check"></i><b>0.8</b> 生成可重复的随机序列</a><ul>
<li class="chapter" data-level="0.8.1" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-7"><i class="fa fa-check"></i><b>0.8.1</b> 问题</a></li>
<li class="chapter" data-level="0.8.2" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-6"><i class="fa fa-check"></i><b>0.8.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.9" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#section-0.9"><i class="fa fa-check"></i><b>0.9</b> 保持随机数生成器的状态</a><ul>
<li class="chapter" data-level="0.9.1" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-8"><i class="fa fa-check"></i><b>0.9.1</b> 问题</a></li>
<li class="chapter" data-level="0.9.2" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-7"><i class="fa fa-check"></i><b>0.9.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.10" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#section-0.10"><i class="fa fa-check"></i><b>0.10</b> 对数值取整</a><ul>
<li class="chapter" data-level="0.10.1" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-9"><i class="fa fa-check"></i><b>0.10.1</b> 问题</a></li>
<li class="chapter" data-level="0.10.2" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-8"><i class="fa fa-check"></i><b>0.10.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.11" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#section-0.11"><i class="fa fa-check"></i><b>0.11</b> 比较浮点数</a><ul>
<li class="chapter" data-level="0.11.1" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-10"><i class="fa fa-check"></i><b>0.11.1</b> 问题</a></li>
<li class="chapter" data-level="0.11.2" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-9"><i class="fa fa-check"></i><b>0.11.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html"><i class="fa fa-check"></i>字符串</a><ul>
<li class="chapter" data-level="0.12" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#grepsubgsub"><i class="fa fa-check"></i><b>0.12</b> 使用grep,sub,gsub进行搜索和替换</a><ul>
<li class="chapter" data-level="0.12.1" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#-11"><i class="fa fa-check"></i><b>0.12.1</b> 问题</a></li>
<li class="chapter" data-level="0.12.2" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-10"><i class="fa fa-check"></i><b>0.12.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.13" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#section-0.13"><i class="fa fa-check"></i><b>0.13</b> 通过变量创建字符串</a><ul>
<li class="chapter" data-level="0.13.1" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#-12"><i class="fa fa-check"></i><b>0.13.1</b> 问题</a></li>
<li class="chapter" data-level="0.13.2" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#-11"><i class="fa fa-check"></i><b>0.13.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html"><i class="fa fa-check"></i>公式</a><ul>
<li class="chapter" data-level="0.14" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#section-0.14"><i class="fa fa-check"></i><b>0.14</b> 通过字符串创建公式</a><ul>
<li class="chapter" data-level="0.14.1" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#-13"><i class="fa fa-check"></i><b>0.14.1</b> 问题</a></li>
<li class="chapter" data-level="0.14.2" data-path="e5ad97e7aca6e4b8b2.html"><a href="e5ad97e7aca6e4b8b2.html#-12"><i class="fa fa-check"></i><b>0.14.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.15" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#section-0.15"><i class="fa fa-check"></i><b>0.15</b> 从公式中提取组分</a><ul>
<li class="chapter" data-level="0.15.1" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#-14"><i class="fa fa-check"></i><b>0.15.1</b> 问题</a></li>
<li class="chapter" data-level="0.15.2" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#-13"><i class="fa fa-check"></i><b>0.15.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><i class="fa fa-check"></i>数据的导入与导出</a><ul>
<li class="chapter" data-level="0.16" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.16</b> R载入文件中的数据</a><ul>
<li class="chapter" data-level="0.16.1" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-15"><i class="fa fa-check"></i><b>0.16.1</b> 问题</a></li>
<li class="chapter" data-level="0.16.2" data-path="e585ace5bc8f.html"><a href="e585ace5bc8f.html#-14"><i class="fa fa-check"></i><b>0.16.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.17" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.17</b> 键盘和剪贴板把数据载入并保存到R</a><ul>
<li class="chapter" data-level="0.17.1" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-16"><i class="fa fa-check"></i><b>0.17.1</b> 问题</a></li>
<li class="chapter" data-level="0.17.2" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-15"><i class="fa fa-check"></i><b>0.17.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.18" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.18</b> 运行R脚本</a><ul>
<li class="chapter" data-level="0.18.1" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-17"><i class="fa fa-check"></i><b>0.18.1</b> 问题</a></li>
<li class="chapter" data-level="0.18.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.18.2</b> 解决</a></li>
</ul></li>
<li class="chapter" data-level="0.19" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.19</b> 用R把数据写入文件</a><ul>
<li class="chapter" data-level="0.19.1" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-18"><i class="fa fa-check"></i><b>0.19.1</b> 问题</a></li>
<li class="chapter" data-level="0.19.2" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-16"><i class="fa fa-check"></i><b>0.19.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.20" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.20</b> 用R写入文本，分析输出到文件</a><ul>
<li class="chapter" data-level="0.20.1" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-19"><i class="fa fa-check"></i><b>0.20.1</b> 问题</a></li>
<li class="chapter" data-level="0.20.2" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-17"><i class="fa fa-check"></i><b>0.20.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html"><i class="fa fa-check"></i>操作数据</a><ul>
<li class="chapter" data-level="0.21" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.21</b> R中的排序问题</a><ul>
<li class="chapter" data-level="0.21.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-20"><i class="fa fa-check"></i><b>0.21.1</b> 问题</a></li>
<li class="chapter" data-level="0.21.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.21.2</b> 解决</a></li>
</ul></li>
<li class="chapter" data-level="0.22" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.22</b> 用R生成随机的顺序</a><ul>
<li class="chapter" data-level="0.22.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-21"><i class="fa fa-check"></i><b>0.22.1</b> 问题</a></li>
<li class="chapter" data-level="0.22.2" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-18"><i class="fa fa-check"></i><b>0.22.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.23" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.23"><i class="fa fa-check"></i><b>0.23</b> 转换向量类型——数值向量，字符串向量和因子向量</a><ul>
<li class="chapter" data-level="0.23.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-22"><i class="fa fa-check"></i><b>0.23.1</b> 问题</a></li>
<li class="chapter" data-level="0.23.2" data-path="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html"><a href="e695b0e68daee79a84e5afbce585a5e4b88ee5afbce587ba.html#-19"><i class="fa fa-check"></i><b>0.23.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.24" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#r"><i class="fa fa-check"></i><b>0.24</b> 用R查找并移除重复的记录</a><ul>
<li class="chapter" data-level="0.24.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-23"><i class="fa fa-check"></i><b>0.24.1</b> 问题</a></li>
<li class="chapter" data-level="0.24.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-20"><i class="fa fa-check"></i><b>0.24.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.25" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#na"><i class="fa fa-check"></i><b>0.25</b> NA存在的情况下，向量或因子间的比较</a><ul>
<li class="chapter" data-level="0.25.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-24"><i class="fa fa-check"></i><b>0.25.1</b> 问题</a></li>
<li class="chapter" data-level="0.25.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-21"><i class="fa fa-check"></i><b>0.25.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.26" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.26"><i class="fa fa-check"></i><b>0.26</b> 数据重新编码</a><ul>
<li class="chapter" data-level="0.26.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-25"><i class="fa fa-check"></i><b>0.26.1</b> 问题</a></li>
<li class="chapter" data-level="0.26.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-22"><i class="fa fa-check"></i><b>0.26.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.27" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#xy"><i class="fa fa-check"></i><b>0.27</b> 将向量中所有值为x的对象改变值y</a><ul>
<li class="chapter" data-level="0.27.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-26"><i class="fa fa-check"></i><b>0.27.1</b> 问题</a></li>
<li class="chapter" data-level="0.27.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-23"><i class="fa fa-check"></i><b>0.27.2</b> 方案</a></li>
<li class="chapter" data-level="0.27.3" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.27.3"><i class="fa fa-check"></i><b>0.27.3</b> 另见</a></li>
</ul></li>
<li class="chapter" data-level="0.28" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.28"><i class="fa fa-check"></i><b>0.28</b> 重命名因子水平</a><ul>
<li class="chapter" data-level="0.28.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-27"><i class="fa fa-check"></i><b>0.28.1</b> 问题</a></li>
<li class="chapter" data-level="0.28.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-24"><i class="fa fa-check"></i><b>0.28.2</b> 方案</a></li>
<li class="chapter" data-level="0.28.3" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.28.3"><i class="fa fa-check"></i><b>0.28.3</b> 更多参考</a></li>
</ul></li>
<li class="chapter" data-level="0.29" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.29"><i class="fa fa-check"></i><b>0.29</b> 重计算因子水平</a><ul>
<li class="chapter" data-level="0.29.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-28"><i class="fa fa-check"></i><b>0.29.1</b> 问题</a></li>
<li class="chapter" data-level="0.29.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-25"><i class="fa fa-check"></i><b>0.29.2</b> 方案</a></li>
<li class="chapter" data-level="0.29.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.29.3</b> 另见</a></li>
</ul></li>
<li class="chapter" data-level="0.30" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.30"><i class="fa fa-check"></i><b>0.30</b> 改变因子水平次序</a><ul>
<li class="chapter" data-level="0.30.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-29"><i class="fa fa-check"></i><b>0.30.1</b> 问题</a></li>
<li class="chapter" data-level="0.30.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-26"><i class="fa fa-check"></i><b>0.30.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.31" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.31"><i class="fa fa-check"></i><b>0.31</b> 重命名数据框的列</a><ul>
<li class="chapter" data-level="0.31.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-30"><i class="fa fa-check"></i><b>0.31.1</b> 问题</a></li>
<li class="chapter" data-level="0.31.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-27"><i class="fa fa-check"></i><b>0.31.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.32" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.32"><i class="fa fa-check"></i><b>0.32</b> 添加和移除数据框的列</a><ul>
<li class="chapter" data-level="0.32.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-31"><i class="fa fa-check"></i><b>0.32.1</b> 问题</a></li>
<li class="chapter" data-level="0.32.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-28"><i class="fa fa-check"></i><b>0.32.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.33" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.33"><i class="fa fa-check"></i><b>0.33</b> 对数据框的列重新排序</a><ul>
<li class="chapter" data-level="0.33.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-32"><i class="fa fa-check"></i><b>0.33.1</b> 问题</a></li>
<li class="chapter" data-level="0.33.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-29"><i class="fa fa-check"></i><b>0.33.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.34" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.34"><i class="fa fa-check"></i><b>0.34</b> 融合数据框</a><ul>
<li class="chapter" data-level="0.34.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-33"><i class="fa fa-check"></i><b>0.34.1</b> 问题</a></li>
<li class="chapter" data-level="0.34.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-30"><i class="fa fa-check"></i><b>0.34.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.35" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.35"><i class="fa fa-check"></i><b>0.35</b> 比较数据框</a><ul>
<li class="chapter" data-level="0.35.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-34"><i class="fa fa-check"></i><b>0.35.1</b> 问题</a></li>
<li class="chapter" data-level="0.35.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-31"><i class="fa fa-check"></i><b>0.35.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.36" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.36"><i class="fa fa-check"></i><b>0.36</b> 重计算数据框所有因子列的水平</a><ul>
<li class="chapter" data-level="0.36.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-35"><i class="fa fa-check"></i><b>0.36.1</b> 问题</a></li>
<li class="chapter" data-level="0.36.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-32"><i class="fa fa-check"></i><b>0.36.2</b> 方案</a></li>
<li class="chapter" data-level="0.36.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.36.3</b> 另见</a></li>
</ul></li>
<li class="chapter" data-level="0.37" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.37"><i class="fa fa-check"></i><b>0.37</b> 长宽格式数据互换</a><ul>
<li class="chapter" data-level="0.37.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-36"><i class="fa fa-check"></i><b>0.37.1</b> 问题</a></li>
<li class="chapter" data-level="0.37.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-33"><i class="fa fa-check"></i><b>0.37.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.38" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.38"><i class="fa fa-check"></i><b>0.38</b> 归纳总结数据</a><ul>
<li class="chapter" data-level="0.38.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-37"><i class="fa fa-check"></i><b>0.38.1</b> 问题</a></li>
<li class="chapter" data-level="0.38.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-34"><i class="fa fa-check"></i><b>0.38.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.39" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.39"><i class="fa fa-check"></i><b>0.39</b> 数据框与列联表互换</a><ul>
<li class="chapter" data-level="0.39.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-38"><i class="fa fa-check"></i><b>0.39.1</b> 问题</a></li>
<li class="chapter" data-level="0.39.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-35"><i class="fa fa-check"></i><b>0.39.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.40" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.40"><i class="fa fa-check"></i><b>0.40</b> 计算移动平均数</a><ul>
<li class="chapter" data-level="0.40.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-39"><i class="fa fa-check"></i><b>0.40.1</b> 问题</a></li>
<li class="chapter" data-level="0.40.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.40.2"><i class="fa fa-check"></i><b>0.40.2</b> 解决方案</a></li>
</ul></li>
<li class="chapter" data-level="0.41" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.41"><i class="fa fa-check"></i><b>0.41</b> 窗口平滑</a><ul>
<li class="chapter" data-level="0.41.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-40"><i class="fa fa-check"></i><b>0.41.1</b> 问题</a></li>
<li class="chapter" data-level="0.41.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-36"><i class="fa fa-check"></i><b>0.41.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.42" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.42"><i class="fa fa-check"></i><b>0.42</b> 寻找唯一值序列</a><ul>
<li class="chapter" data-level="0.42.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-41"><i class="fa fa-check"></i><b>0.42.1</b> 问题</a></li>
<li class="chapter" data-level="0.42.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-37"><i class="fa fa-check"></i><b>0.42.2</b> 方案</a></li>
<li class="chapter" data-level="0.42.3" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#section-0.42.3"><i class="fa fa-check"></i><b>0.42.3</b> 向量上运行</a></li>
</ul></li>
<li class="chapter" data-level="0.43" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#nana"><i class="fa fa-check"></i><b>0.43</b> 用最后的非NA值填充NA值</a><ul>
<li class="chapter" data-level="0.43.1" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-42"><i class="fa fa-check"></i><b>0.43.1</b> 问题</a></li>
<li class="chapter" data-level="0.43.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-38"><i class="fa fa-check"></i><b>0.43.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html"><i class="fa fa-check"></i>统计分析</a><ul>
<li class="chapter" data-level="0.44" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#section-0.44"><i class="fa fa-check"></i><b>0.44</b> 回归和相关分析</a><ul>
<li class="chapter" data-level="0.44.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-43"><i class="fa fa-check"></i><b>0.44.1</b> 问题</a></li>
<li class="chapter" data-level="0.44.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-39"><i class="fa fa-check"></i><b>0.44.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.45" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#t"><i class="fa fa-check"></i><b>0.45</b> t检验</a><ul>
<li class="chapter" data-level="0.45.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-44"><i class="fa fa-check"></i><b>0.45.1</b> 问题</a></li>
<li class="chapter" data-level="0.45.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-40"><i class="fa fa-check"></i><b>0.45.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.46" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#section-0.46"><i class="fa fa-check"></i><b>0.46</b> 频数检验</a><ul>
<li class="chapter" data-level="0.46.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-45"><i class="fa fa-check"></i><b>0.46.1</b> 问题</a></li>
<li class="chapter" data-level="0.46.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-41"><i class="fa fa-check"></i><b>0.46.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.47" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#anova"><i class="fa fa-check"></i><b>0.47</b> ANOVA</a><ul>
<li class="chapter" data-level="0.47.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-46"><i class="fa fa-check"></i><b>0.47.1</b> 问题</a></li>
<li class="chapter" data-level="0.47.2" data-path="e6938de4bd9ce695b0e68dae.html"><a href="e6938de4bd9ce695b0e68dae.html#-42"><i class="fa fa-check"></i><b>0.47.2</b> 方案</a></li>
<li class="chapter" data-level="0.47.3" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#anovas"><i class="fa fa-check"></i><b>0.47.3</b> 有受试内变量的ANOVAs</a></li>
</ul></li>
<li class="chapter" data-level="0.48" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#section-0.48"><i class="fa fa-check"></i><b>0.48</b> 逻辑回归</a><ul>
<li class="chapter" data-level="0.48.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-47"><i class="fa fa-check"></i><b>0.48.1</b> 问题</a></li>
<li class="chapter" data-level="0.48.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-43"><i class="fa fa-check"></i><b>0.48.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.49" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#section-0.49"><i class="fa fa-check"></i><b>0.49</b> 变量同质性</a><ul>
<li class="chapter" data-level="0.49.1" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-48"><i class="fa fa-check"></i><b>0.49.1</b> 问题</a></li>
<li class="chapter" data-level="0.49.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-44"><i class="fa fa-check"></i><b>0.49.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html"><i class="fa fa-check"></i>图形</a><ul>
<li class="chapter" data-level="0.50" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.50"><i class="fa fa-check"></i><b>0.50</b> 条形图与线图</a><ul>
<li class="chapter" data-level="0.50.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-49"><i class="fa fa-check"></i><b>0.50.1</b> 问题</a></li>
<li class="chapter" data-level="0.50.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-45"><i class="fa fa-check"></i><b>0.50.2</b> 方案</a></li>
<li class="chapter" data-level="0.50.3" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.50.3"><i class="fa fa-check"></i><b>0.50.3</b> 有更多变量的图</a></li>
<li class="chapter" data-level="0.50.4" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-x-axis"><i class="fa fa-check"></i><b>0.50.4</b> 使用数值 x-axis</a></li>
</ul></li>
<li class="chapter" data-level="0.51" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.51"><i class="fa fa-check"></i><b>0.51</b> 绘制均值和误差棒</a><ul>
<li class="chapter" data-level="0.51.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-50"><i class="fa fa-check"></i><b>0.51.1</b> 问题</a></li>
<li class="chapter" data-level="0.51.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-46"><i class="fa fa-check"></i><b>0.51.2</b> 方案</a></li>
<li class="chapter" data-level="0.51.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.51.3</b> 线图</a></li>
<li class="chapter" data-level="0.51.4" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.51.4"><i class="fa fa-check"></i><b>0.51.4</b> 直方图</a></li>
<li class="chapter" data-level="0.51.5" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.51.5"><i class="fa fa-check"></i><b>0.51.5</b> 为组内变量添加误差棒</a></li>
<li class="chapter" data-level="0.51.6" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.51.6"><i class="fa fa-check"></i><b>0.51.6</b> 注意标准化的均值</a></li>
<li class="chapter" data-level="0.51.7" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.51.7"><i class="fa fa-check"></i><b>0.51.7</b> 助手函数</a></li>
<li class="chapter" data-level="0.51.8" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.51.8</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="0.52" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot-"><i class="fa fa-check"></i><b>0.52</b> ggplot | 绘制分布图</a><ul>
<li class="chapter" data-level="0.52.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-51"><i class="fa fa-check"></i><b>0.52.1</b> 问题</a></li>
<li class="chapter" data-level="0.52.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-47"><i class="fa fa-check"></i><b>0.52.2</b> 方案</a></li>
<li class="chapter" data-level="0.52.3" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.52.3"><i class="fa fa-check"></i><b>0.52.3</b> 直方图和概率密度图</a></li>
<li class="chapter" data-level="0.52.4" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.52.4"><i class="fa fa-check"></i><b>0.52.4</b> 多组数据的直方图和概率密度图</a></li>
</ul></li>
<li class="chapter" data-level="0.53" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.53"><i class="fa fa-check"></i><b>0.53</b> 箱型图</a></li>
<li class="chapter" data-level="0.54" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot"><i class="fa fa-check"></i><b>0.54</b> ggplot|散点图</a><ul>
<li class="chapter" data-level="0.54.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-52"><i class="fa fa-check"></i><b>0.54.1</b> 问题</a></li>
<li class="chapter" data-level="0.54.2" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-48"><i class="fa fa-check"></i><b>0.54.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.55" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot-"><i class="fa fa-check"></i><b>0.55</b> ggplot | 标题</a><ul>
<li class="chapter" data-level="0.55.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-53"><i class="fa fa-check"></i><b>0.55.1</b> 问题</a></li>
<li class="chapter" data-level="0.55.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-49"><i class="fa fa-check"></i><b>0.55.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.56" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot"><i class="fa fa-check"></i><b>0.56</b> ggplot|坐标轴</a><ul>
<li class="chapter" data-level="0.56.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-54"><i class="fa fa-check"></i><b>0.56.1</b> 问题</a></li>
<li class="chapter" data-level="0.56.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-50"><i class="fa fa-check"></i><b>0.56.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.57" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-ggplot2"><i class="fa fa-check"></i><b>0.57</b> 图例 (ggplot2)</a><ul>
<li class="chapter" data-level="0.57.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-55"><i class="fa fa-check"></i><b>0.57.1</b> 问题</a></li>
<li class="chapter" data-level="0.57.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.57.2</b> 解决方案</a></li>
<li class="chapter" data-level="0.57.3" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.57.3"><i class="fa fa-check"></i><b>0.57.3</b> 修改图例标题和标签的外观</a></li>
<li class="chapter" data-level="0.57.4" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.57.4"><i class="fa fa-check"></i><b>0.57.4</b> 修改图例框</a></li>
<li class="chapter" data-level="0.57.5" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.57.5"><i class="fa fa-check"></i><b>0.57.5</b> 改变图例位置</a></li>
<li class="chapter" data-level="0.57.6" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.57.6"><i class="fa fa-check"></i><b>0.57.6</b> 隐藏在图例中的斜线</a></li>
<li class="chapter" data-level="0.57.7" data-path="e695b0e5ad97.html"><a href="e695b0e5ad97.html#-9"><i class="fa fa-check"></i><b>0.57.7</b> 注意</a></li>
</ul></li>
<li class="chapter" data-level="0.58" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-ggplot2"><i class="fa fa-check"></i><b>0.58</b> 线条 (ggplot2)</a><ul>
<li class="chapter" data-level="0.58.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-56"><i class="fa fa-check"></i><b>0.58.1</b> 问题</a></li>
<li class="chapter" data-level="0.58.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-2"><i class="fa fa-check"></i><b>0.58.2</b> 解决方案</a></li>
</ul></li>
<li class="chapter" data-level="0.59" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot-"><i class="fa fa-check"></i><b>0.59</b> ggplot | 分面</a><ul>
<li class="chapter" data-level="0.59.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-57"><i class="fa fa-check"></i><b>0.59.1</b> 问题</a></li>
<li class="chapter" data-level="0.59.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-51"><i class="fa fa-check"></i><b>0.59.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.60" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot-"><i class="fa fa-check"></i><b>0.60</b> ggplot |多图</a><ul>
<li class="chapter" data-level="0.60.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-58"><i class="fa fa-check"></i><b>0.60.1</b> 问题</a></li>
<li class="chapter" data-level="0.60.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-52"><i class="fa fa-check"></i><b>0.60.2</b> 方案</a></li>
<li class="chapter" data-level="0.60.3" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#multiplot-"><i class="fa fa-check"></i><b>0.60.3</b> multiplot 函数</a></li>
</ul></li>
<li class="chapter" data-level="0.61" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#ggplot2"><i class="fa fa-check"></i><b>0.61</b> 颜色（ggplot2)</a><ul>
<li class="chapter" data-level="0.61.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-59"><i class="fa fa-check"></i><b>0.61.1</b> 问题</a></li>
<li class="chapter" data-level="0.61.2" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-3"><i class="fa fa-check"></i><b>0.61.2</b> 解决方案</a></li>
</ul></li>
<li class="chapter" data-level="0.62" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#--pdf-png-tiff-svg"><i class="fa fa-check"></i><b>0.62</b> 图形混杂-输出到文件-PDF-PNG-TIFF-SVG</a><ul>
<li class="chapter" data-level="0.62.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-60"><i class="fa fa-check"></i><b>0.62.1</b> 问题</a></li>
<li class="chapter" data-level="0.62.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-53"><i class="fa fa-check"></i><b>0.62.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.63" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-"><i class="fa fa-check"></i><b>0.63</b> 图形混杂-形状和线形</a><ul>
<li class="chapter" data-level="0.63.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-61"><i class="fa fa-check"></i><b>0.63.1</b> 问题</a></li>
<li class="chapter" data-level="0.63.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-54"><i class="fa fa-check"></i><b>0.63.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.64" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-"><i class="fa fa-check"></i><b>0.64</b> 图形混杂-字体</a><ul>
<li class="chapter" data-level="0.64.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-62"><i class="fa fa-check"></i><b>0.64.1</b> 问题</a></li>
<li class="chapter" data-level="0.64.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-55"><i class="fa fa-check"></i><b>0.64.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.65" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-"><i class="fa fa-check"></i><b>0.65</b> 图形混杂-抗混淆位图输出</a><ul>
<li class="chapter" data-level="0.65.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-63"><i class="fa fa-check"></i><b>0.65.1</b> 问题</a></li>
<li class="chapter" data-level="0.65.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-56"><i class="fa fa-check"></i><b>0.65.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.66" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-"><i class="fa fa-check"></i><b>0.66</b> 标准绘图 | 散点图</a><ul>
<li class="chapter" data-level="0.66.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-64"><i class="fa fa-check"></i><b>0.66.1</b> 问题</a></li>
<li class="chapter" data-level="0.66.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-57"><i class="fa fa-check"></i><b>0.66.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.67" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#section-0.67"><i class="fa fa-check"></i><b>0.67</b> 标准绘图|箱线图</a><ul>
<li class="chapter" data-level="0.67.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-65"><i class="fa fa-check"></i><b>0.67.1</b> 问题</a></li>
<li class="chapter" data-level="0.67.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-58"><i class="fa fa-check"></i><b>0.67.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.68" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#qq"><i class="fa fa-check"></i><b>0.68</b> 标准绘图|QQ图</a><ul>
<li class="chapter" data-level="0.68.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-66"><i class="fa fa-check"></i><b>0.68.1</b> 问题</a></li>
<li class="chapter" data-level="0.68.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-59"><i class="fa fa-check"></i><b>0.68.2</b> 方案</a></li>
</ul></li>
<li class="chapter" data-level="0.69" data-path="e7bb9fe8aea1e58886e69e90.html"><a href="e7bb9fe8aea1e58886e69e90.html#-"><i class="fa fa-check"></i><b>0.69</b> 其他有趣图形-相关矩阵</a><ul>
<li class="chapter" data-level="0.69.1" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-67"><i class="fa fa-check"></i><b>0.69.1</b> 问题</a></li>
<li class="chapter" data-level="0.69.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-60"><i class="fa fa-check"></i><b>0.69.2</b> 方案</a></li>
<li class="chapter" data-level="0.69.3" data-path="e59fbae7a180.html"><a href="e59fbae7a180.html#-1"><i class="fa fa-check"></i><b>0.69.3</b> 提示</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html"><i class="fa fa-check"></i>脚本与函数</a><ul>
<li class="chapter" data-level="0.70" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.70"><i class="fa fa-check"></i><b>0.70</b> 创建和运行一个脚本</a><ul>
<li class="chapter" data-level="0.70.1" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.70.1"><i class="fa fa-check"></i><b>0.70.1</b> 参考文献：</a></li>
</ul></li>
<li class="chapter" data-level="0.71" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.71"><i class="fa fa-check"></i><b>0.71</b> 调试脚本或函数</a><ul>
<li class="chapter" data-level="0.71.1" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#-68"><i class="fa fa-check"></i><b>0.71.1</b> 问题</a></li>
<li class="chapter" data-level="0.71.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-61"><i class="fa fa-check"></i><b>0.71.2</b> 方案</a></li>
<li class="chapter" data-level="0.71.3" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.71.3"><i class="fa fa-check"></i><b>0.71.3</b> <strong>有用的选择</strong></a></li>
</ul></li>
<li class="chapter" data-level="0.72" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.72"><i class="fa fa-check"></i><b>0.72</b> 测量经过的时间</a><ul>
<li class="chapter" data-level="0.72.1" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#-69"><i class="fa fa-check"></i><b>0.72.1</b> <strong>问题</strong></a></li>
</ul></li>
<li class="chapter" data-level="0.73" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#section-0.73"><i class="fa fa-check"></i><b>0.73</b> 获取包中的函数和对象列表</a><ul>
<li class="chapter" data-level="0.73.1" data-path="e8849ae69cace4b88ee587bde695b0.html"><a href="e8849ae69cace4b88ee587bde695b0.html#-70"><i class="fa fa-check"></i><b>0.73.1</b> 问题</a></li>
<li class="chapter" data-level="0.73.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-62"><i class="fa fa-check"></i><b>0.73.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="e5b7a5e585b7.html"><a href="e5b7a5e585b7.html"><i class="fa fa-check"></i>工具</a><ul>
<li class="chapter" data-level="0.74" data-path="e5b7a5e585b7.html"><a href="e5b7a5e585b7.html#section-0.74"><i class="fa fa-check"></i><b>0.74</b> 生成拉丁方</a><ul>
<li class="chapter" data-level="0.74.1" data-path="e5b7a5e585b7.html"><a href="e5b7a5e585b7.html#-71"><i class="fa fa-check"></i><b>0.74.1</b> 问题</a></li>
<li class="chapter" data-level="0.74.2" data-path="e59bbee5bda2.html"><a href="e59bbee5bda2.html#-63"><i class="fa fa-check"></i><b>0.74.2</b> 方案</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="A" data-path="materials.html"><a href="materials.html"><i class="fa fa-check"></i><b>A</b> 资料推荐</a></li>
<li class="chapter" data-level="B" data-path="books.html"><a href="books.html"><i class="fa fa-check"></i><b>B</b> 图书推荐</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cookbook for R 中文版</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="e7bb9fe8aea1e58886e69e90" class="section level1 unnumbered">
<h1>统计分析</h1>
<div id="section-0.44" class="section level2">
<h2><span class="header-section-number">0.44</span> 回归和相关分析</h2>
<div id="-43" class="section level3">
<h3><span class="header-section-number">0.44.1</span> 问题</h3>
<p>你想要做线性回归和/或相关分析。</p>
</div>
<div id="-39" class="section level3">
<h3><span class="header-section-number">0.44.2</span> 方案</h3>
<p>要处理的一些样例数据：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 制造一些数据</span>
<span class="co"># X增加（大的干扰噪声）</span>
<span class="co"># Z缓慢增加</span>
<span class="co"># 构建Y，它与X变量负相关，与X*Z变量正相关</span>
<span class="kw">set.seed</span>(<span class="dv">955</span>)
xvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dt">sd=</span><span class="dv">3</span>)
zvar &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dt">sd=</span><span class="dv">2</span>)
yvar &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>xvar <span class="op">+</span><span class="st"> </span>xvar<span class="op">*</span>zvar<span class="op">/</span><span class="dv">5</span> <span class="op">+</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>,<span class="dt">sd=</span><span class="dv">4</span>)

<span class="co"># 用制造的变量构建数据框</span>
dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>xvar, <span class="dt">y=</span>yvar, <span class="dt">z=</span>zvar)
<span class="co"># 展示头部几行</span>
<span class="kw">head</span>(dat)
<span class="co">#&gt;           x           y           z</span>
<span class="co">#&gt; 1 -4.252354   4.5857688  1.89877152</span>
<span class="co">#&gt; 2  1.702318  -4.9027824 -0.82937359</span>
<span class="co">#&gt; 3  4.323054  -4.3076433 -1.31283495</span>
<span class="co">#&gt; 4  1.780628   0.2050367 -0.28479448</span>
<span class="co">#&gt; 5 11.537348 -29.7670502 -1.27303976</span>
<span class="co">#&gt; 6  6.672130 -10.1458220 -0.09459239</span></code></pre></div>
<div id="section-0.44.2.1" class="section level4">
<h4><span class="header-section-number">0.44.2.1</span> 相关</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 相关系数</span>
<span class="kw">cor</span>(dat<span class="op">$</span>x, dat<span class="op">$</span>y)
<span class="co">#&gt; [1] -0.7695378</span></code></pre></div>
</div>
<div id="section-0.44.2.2" class="section level4">
<h4><span class="header-section-number">0.44.2.2</span> 相关矩阵（多个变量）</h4>
<p>我们也可以对多个配对变量进行相关分析操作，结果是一个矩阵或是数据框。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 变量之间的相关矩阵</span>
<span class="kw">cor</span>(dat)
<span class="co">#&gt;            x            y           z</span>
<span class="co">#&gt; x  1.0000000 -0.769537849 0.491698938</span>
<span class="co">#&gt; y -0.7695378  1.000000000 0.004172295</span>
<span class="co">#&gt; z  0.4916989  0.004172295 1.000000000</span>


<span class="co"># Print with only two decimal places</span>
<span class="kw">round</span>(<span class="kw">cor</span>(dat), <span class="dv">2</span>)
<span class="co">#&gt;       x     y    z</span>
<span class="co">#&gt; x  1.00 -0.77 0.49</span>
<span class="co">#&gt; y -0.77  1.00 0.00</span>
<span class="co">#&gt; z  0.49  0.00 1.00</span></code></pre></div>
</div>
<div id="section-0.44.2.3" class="section level4">
<h4><span class="header-section-number">0.44.2.3</span> 线性回归</h4>
<p>线性回归，当<code>dat$x</code>是预测变量时，<code>dat$y</code>为响应变量。这可以使用一个数据框的两列，或者是直接使用数值向量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 下面两个命令会显示一样的结果</span>
fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data=</span>dat)  <span class="co"># 使用数据框的x列和y列</span>
fit &lt;-<span class="st"> </span><span class="kw">lm</span>(dat<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>dat<span class="op">$</span>x)     <span class="co"># 使用dat$x和dat$y进行拟合</span>
fit
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = dat$y ~ dat$x)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)        dat$x  </span>
<span class="co">#&gt;     -0.2278      -1.1829</span>

<span class="co"># 这说明预测 y = -0.2278 - 1.1829*x</span>



<span class="co"># 获取更详细的信息</span>
<span class="kw">summary</span>(fit)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = dat$y ~ dat$x)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -15.8922  -2.5114   0.2866   4.4646   9.3285 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  -0.2278     2.6323  -0.087    0.932    </span>
<span class="co">#&gt; dat$x        -1.1829     0.2314  -5.113 7.28e-05 ***</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 6.506 on 18 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.5922, Adjusted R-squared:  0.5695 </span>
<span class="co">#&gt; F-statistic: 26.14 on 1 and 18 DF,  p-value: 7.282e-05</span></code></pre></div>
</div>
<div id="section-0.44.2.4" class="section level4">
<h4><span class="header-section-number">0.44.2.4</span> 多个预测变量的线性回归（多元线性回归）</h4>
<p>使用<code>y</code>作为线性回归的响应变量，<code>x</code>和<code>z</code>作为预测变量。</p>
<p>注意下面的公式没有检测<code>x</code>与<code>z</code>之间的交互效应。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 这些都有相同的结果</span>
fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z, <span class="dt">data=</span>dat)    <span class="co"># 使用数据框的x,y,z列</span>
fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(dat<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>dat<span class="op">$</span>x <span class="op">+</span><span class="st"> </span>dat<span class="op">$</span>z)  <span class="co"># 使用向量</span>
fit2
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = dat$y ~ dat$x + dat$z)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)        dat$x        dat$z  </span>
<span class="co">#&gt;      -1.382       -1.564        1.858</span>


<span class="kw">summary</span>(fit2)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = dat$y ~ dat$x + dat$z)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;    Min     1Q Median     3Q    Max </span>
<span class="co">#&gt; -7.974 -3.187 -1.205  3.847  7.524 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  -1.3816     1.9878  -0.695  0.49644    </span>
<span class="co">#&gt; dat$x        -1.5642     0.1984  -7.883 4.46e-07 ***</span>
<span class="co">#&gt; dat$z         1.8578     0.4753   3.908  0.00113 ** </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 4.859 on 17 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.7852, Adjusted R-squared:  0.7599 </span>
<span class="co">#&gt; F-statistic: 31.07 on 2 and 17 DF,  p-value: 2.1e-06</span></code></pre></div>
<div id="section-0.44.2.4.1" class="section level5">
<h5><span class="header-section-number">0.44.2.4.1</span> 交互效应</h5>
<p>如何合适地构建多元线性回归并且检验交互效应非常复杂，这里不作讲述。这里我们仅仅用<code>x</code>和<code>z</code>变量以及它们之间的交互效应拟合模型。</p>
<p>想要构建<code>x</code>与<code>z</code>之间的交互效应模型，需要添加<code>x:z</code>项。我们也可以使用公式<code>x*z</code>来代表<code>x+z+x:z</code>。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 下面两个公式等效</span>
fit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>z, <span class="dt">data=</span>dat) 
fit3 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>z <span class="op">+</span><span class="st"> </span>x<span class="op">:</span>z, <span class="dt">data=</span>dat) 
fit3
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = y ~ x + z + x:z, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)            x            z          x:z  </span>
<span class="co">#&gt;      2.2820      -2.1311      -0.1068       0.2081</span>

<span class="kw">summary</span>(fit3)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = y ~ x + z + x:z, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;     Min      1Q  Median      3Q     Max </span>
<span class="co">#&gt; -5.3045 -3.5998  0.3926  2.1376  8.3957 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; (Intercept)  2.28204    2.20064   1.037   0.3152    </span>
<span class="co">#&gt; x           -2.13110    0.27406  -7.776    8e-07 ***</span>
<span class="co">#&gt; z           -0.10682    0.84820  -0.126   0.9013    </span>
<span class="co">#&gt; x:z          0.20814    0.07874   2.643   0.0177 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 4.178 on 16 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.8505, Adjusted R-squared:  0.8225 </span>
<span class="co">#&gt; F-statistic: 30.34 on 3 and 16 DF,  p-value: 7.759e-07</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="t" class="section level2">
<h2><span class="header-section-number">0.45</span> t检验</h2>
<div id="-44" class="section level3">
<h3><span class="header-section-number">0.45.1</span> 问题</h3>
<p>你想要检验来自两个总体的样本是否有不同的均值（显著性差异），或者检验从一个总体抽取的样本均值和理论均值有显著性差异。</p>
</div>
<div id="-40" class="section level3">
<h3><span class="header-section-number">0.45.2</span> 方案</h3>
<div id="section-0.45.2.1" class="section level4">
<h4><span class="header-section-number">0.45.2.1</span> 样本数据</h4>
<p>我们将使用内置的<code>sleep</code>数据集。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sleep
<span class="co">#&gt;    extra group ID</span>
<span class="co">#&gt; 1    0.7     1  1</span>
<span class="co">#&gt; 2   -1.6     1  2</span>
<span class="co">#&gt; 3   -0.2     1  3</span>
<span class="co">#&gt; 4   -1.2     1  4</span>
<span class="co">#&gt; 5   -0.1     1  5</span>
<span class="co">#&gt; 6    3.4     1  6</span>
<span class="co">#&gt; 7    3.7     1  7</span>
<span class="co">#&gt; 8    0.8     1  8</span>
<span class="co">#&gt; 9    0.0     1  9</span>
<span class="co">#&gt; 10   2.0     1 10</span>
<span class="co">#&gt; 11   1.9     2  1</span>
<span class="co">#&gt; 12   0.8     2  2</span>
<span class="co">#&gt; 13   1.1     2  3</span>
<span class="co">#&gt; 14   0.1     2  4</span>
<span class="co">#&gt; 15  -0.1     2  5</span>
<span class="co">#&gt; 16   4.4     2  6</span>
<span class="co">#&gt; 17   5.5     2  7</span>
<span class="co">#&gt; 18   1.6     2  8</span>
<span class="co">#&gt; 19   4.6     2  9</span>
<span class="co">#&gt; 20   3.4     2 10</span></code></pre></div>
<p>我们将制造<code>sleep</code>数据的宽格式版本；下面我们将看看如何处理长格式和宽格式的数据。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sleep_wide &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,
    <span class="dt">group1=</span>sleep<span class="op">$</span>extra[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>],
    <span class="dt">group2=</span>sleep<span class="op">$</span>extra[<span class="dv">11</span><span class="op">:</span><span class="dv">20</span>]
)
sleep_wide
<span class="co">#&gt;    ID group1 group2</span>
<span class="co">#&gt; 1   1    0.7    1.9</span>
<span class="co">#&gt; 2   2   -1.6    0.8</span>
<span class="co">#&gt; 3   3   -0.2    1.1</span>
<span class="co">#&gt; 4   4   -1.2    0.1</span>
<span class="co">#&gt; 5   5   -0.1   -0.1</span>
<span class="co">#&gt; 6   6    3.4    4.4</span>
<span class="co">#&gt; 7   7    3.7    5.5</span>
<span class="co">#&gt; 8   8    0.8    1.6</span>
<span class="co">#&gt; 9   9    0.0    4.6</span>
<span class="co">#&gt; 10 10    2.0    3.4</span></code></pre></div>
</div>
<div id="t" class="section level4">
<h4><span class="header-section-number">0.45.2.2</span> 比较两组：独立双样本t检验</h4>
<p>假设有两组独立样本（我们这里忽略ID变量）。</p>
<p><code>t.test</code>函数能够操作像<code>sleep</code>这样的长格式数据——一列记录测量值，一列指定组别；或者操作两个单独的向量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Welch t-test </span>
<span class="kw">t.test</span>(extra <span class="op">~</span><span class="st"> </span>group, sleep)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Welch Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  extra by group</span>
<span class="co">#&gt; t = -1.8608, df = 17.776, p-value = 0.07939</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -3.3654832  0.2054832</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group 1 mean in group 2 </span>
<span class="co">#&gt;            0.75            2.33</span>

<span class="co"># Same for wide data (two separate vectors)</span>
<span class="co"># t.test(sleep_wide$group1, sleep_wide$group2)</span></code></pre></div>
<p>默认，<code>t.test</code>不假设有方差齐性（或称作方差同质）。默认的不是Student t检验而是使用了Welch t检验。注意Welch t-test结果中df=17.776，这是因为对不同质方差进行了校正。要使用Student t检验的话，设置<code>var.equal=TRUE</code>。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Student t-test</span>
<span class="kw">t.test</span>(extra <span class="op">~</span><span class="st"> </span>group, sleep, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Two Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  extra by group</span>
<span class="co">#&gt; t = -1.8608, df = 18, p-value = 0.07919</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -3.363874  0.203874</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean in group 1 mean in group 2 </span>
<span class="co">#&gt;            0.75            2.33</span>

<span class="co"># Same for wide data (two separate vectors)</span>
<span class="co"># t.test(sleep_wide$group1, sleep_wide$group2, var.equal=TRUE)</span></code></pre></div>
</div>
<div id="t" class="section level4">
<h4><span class="header-section-number">0.45.2.3</span> 配对样本t检验</h4>
<p>你也可以使用配对样本t检验比较配对的数据。数据配对是指你可能有对某种药物治疗前后有观测值或者不同治疗有配对的研究对象。</p>
<p>再次说明，<code>t-test</code>函数可以用于有分组变量的数据框或者两个向量。它依赖相对位置来决定配对。如果你使用有分组变量的长格式数据，group=1的第一行与group2的第一行配对。确保数据排序好并且不存在缺失值是非常重要的；否则配对可以丢弃。这种情况中，我们能通过<code>group</code>和<code>ID</code>变量进行排序来确保顺序是一样的。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sort by group then ID</span>
sleep &lt;-<span class="st"> </span>sleep[<span class="kw">order</span>(sleep<span class="op">$</span>group, sleep<span class="op">$</span>ID), ]

<span class="co"># Paired t-test</span>
<span class="kw">t.test</span>(extra <span class="op">~</span><span class="st"> </span>group, sleep, <span class="dt">paired=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Paired t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  extra by group</span>
<span class="co">#&gt; t = -4.0621, df = 9, p-value = 0.002833</span>
<span class="co">#&gt; alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  -2.4598858 -0.7001142</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of the differences </span>
<span class="co">#&gt;                   -1.58</span>

<span class="co"># Same for wide data (two separate vectors)</span>
<span class="co"># t.test(sleep.wide$group1, sleep.wide$group2, paired=TRUE)</span></code></pre></div>
<p>配对t检验等价于检测是否配对的观察值的总体均值是否为0。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sleep.wide<span class="op">$</span>group1 <span class="op">-</span><span class="st"> </span>sleep.wide<span class="op">$</span>group2, <span class="dt">mu=</span><span class="dv">0</span>, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; Error in t.test(sleep.wide$group1 - sleep.wide$group2, mu = 0, var.equal = TRUE): object &#39;sleep.wide&#39; not found</span></code></pre></div>
</div>
<div id="t" class="section level4">
<h4><span class="header-section-number">0.45.2.4</span> 与期望的总体均值进行比较：单样本t检验</h4>
<p>假设你想要检测是否<code>extra</code>列的数据抽取自总体均值为0的总体。（这里忽略<code>group</code>与<code>ID</code>列）</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(sleep<span class="op">$</span>extra, <span class="dt">mu=</span><span class="dv">0</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  One Sample t-test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  sleep$extra</span>
<span class="co">#&gt; t = 3.413, df = 19, p-value = 0.002918</span>
<span class="co">#&gt; alternative hypothesis: true mean is not equal to 0</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.5955845 2.4844155</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; mean of x </span>
<span class="co">#&gt;      1.54</span></code></pre></div>
</div>
</div>
</div>
<div id="section-0.46" class="section level2">
<h2><span class="header-section-number">0.46</span> 频数检验</h2>
<div id="-45" class="section level3">
<h3><span class="header-section-number">0.46.1</span> 问题</h3>
<p>你有分类数据然后想要检验是否这些数据值的频数分布是否与预期不符，或者是否组间的频数分布有（显著）差异。</p>
</div>
<div id="-41" class="section level3">
<h3><span class="header-section-number">0.46.2</span> 方案</h3>
<p>频数检验通常解决两类问题：</p>
<ol style="list-style-type: decimal">
<li>频数分布与预期或者理论的分布（比如50%的yes，50%的no）符合吗？（拟合优度检验）</li>
<li>两组或多组之间的频率分布有差异吗？（独立检验）</li>
</ol>
<p>通常用于解决这样问题的统计检验方法，分为<strong>精确检验</strong>与<strong>近似检验</strong>两种。</p>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>期望分布</strong></th>
<th><strong>比较组别</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>精确</strong></td>
<td>精确二项检验</td>
<td>Fisher精确检验</td>
</tr>
<tr class="even">
<td><strong>近似</strong></td>
<td>卡方拟合优度</td>
<td>独立卡方检验</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>：精确二项检验仅能用于有两个水平的单变量。Fisher精确检验仅能用于二维列联表（比如，当存在一个独立变量和一个非独立变量时它可以使用；但不能用于两个独立变量和一个非独立变量的情况）。</p>
<p>想要检验配对或被试内效应，我们可以使用McNemar检验。使用该检验必须满足存在两个水平的独立变量和两个水平的非独立变量。</p>
<p>想要检验有重复测量的两个变量独立性，我们可以使用Cochran-Mantel-Haenszel 检验。</p>
<p>假设你有下面的数据，其中每一行代表一个记录：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="st">&#39;</span>
<span class="st"> condition result</span>
<span class="st">   control      0</span>
<span class="st">   control      0</span>
<span class="st">   control      0</span>
<span class="st">   control      0</span>
<span class="st"> treatment      1</span>
<span class="st">   control      0</span>
<span class="st">   control      0</span>
<span class="st"> treatment      0</span>
<span class="st"> treatment      1</span>
<span class="st">   control      1</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      0</span>
<span class="st">   control      0</span>
<span class="st">   control      1</span>
<span class="st">   control      0</span>
<span class="st">   control      1</span>
<span class="st"> treatment      0</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      0</span>
<span class="st"> treatment      0</span>
<span class="st">   control      0</span>
<span class="st"> treatment      1</span>
<span class="st">   control      0</span>
<span class="st">   control      0</span>
<span class="st"> treatment      1</span>
<span class="st"> treatment      0</span>
<span class="st"> treatment      1</span>
<span class="st">&#39;</span>)</code></pre></div>
<p>相比于以<strong>记录</strong>的数据框存储，你的数据可能是<strong>计数</strong>的数据框，或者是一个列联表。</p>
<div id="-" class="section level4">
<h4><span class="header-section-number">0.46.2.1</span> 拟合优度检验 （期望频率）</h4>
<div id="section-0.46.2.1.1" class="section level5">
<h5><span class="header-section-number">0.46.2.1.1</span> 卡方检验</h5>
<p>想要检验假设：结果列result（忽略条件condition）中的两个值在总体中几乎相等（50%-50%）。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#　为result列创建列联表，包含0和1两个值</span>
<span class="co">#　注意“０”和“１”是列名而不是实际的值</span>

ct &lt;-<span class="st"> </span><span class="kw">table</span>(data<span class="op">$</span>result)
ct
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  1 </span>
<span class="co">#&gt; 17 13</span>

<span class="co"># 也可以手动创建表格</span>
<span class="co">#ct &lt;- matrix(c(17,13), ncol=2)</span>
<span class="co">#colnames(ct1) &lt;- c(&quot;0&quot;, &quot;1&quot;)</span>

<span class="co"># 执行卡方检验</span>
<span class="kw">chisq.test</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Chi-squared test for given probabilities</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; X-squared = 0.53333, df = 1, p-value = 0.4652</span></code></pre></div>
<p>想要检验有不同期望频率的样本（比如下面一个0.75，一个0.25）：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 概率表 —— 和必须为1</span>
pt &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">75</span>, .<span class="dv">25</span>)
<span class="kw">chisq.test</span>(ct, <span class="dt">p=</span>pt)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Chi-squared test for given probabilities</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; X-squared = 5.3778, df = 1, p-value = 0.02039</span></code></pre></div>
<p>如果你想要从检验结果中提取信息，可以将结果保存进一个变量，然后用<code>str()</code>函数查看变量信息，接着把你想要的部分取出来。例如：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chi_res &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(ct, <span class="dt">p=</span>pt)
<span class="co"># View all the parts that can be extracted</span>
<span class="kw">str</span>(chi_res)
<span class="co">#&gt; List of 9</span>
<span class="co">#&gt;  $ statistic: Named num 5.38</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;X-squared&quot;</span>
<span class="co">#&gt;  $ parameter: Named num 1</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;</span>
<span class="co">#&gt;  $ p.value  : num 0.0204</span>
<span class="co">#&gt;  $ method   : chr &quot;Chi-squared test for given probabilities&quot;</span>
<span class="co">#&gt;  $ data.name: chr &quot;ct&quot;</span>
<span class="co">#&gt;  $ observed : &#39;table&#39; int [1:2(1d)] 17 13</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 1</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;0&quot; &quot;1&quot;</span>
<span class="co">#&gt;  $ expected : Named num [1:2] 22.5 7.5</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;0&quot; &quot;1&quot;</span>
<span class="co">#&gt;  $ residuals: table [1:2(1d)] -1.16 2.01</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 1</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;0&quot; &quot;1&quot;</span>
<span class="co">#&gt;  $ stdres   : table [1:2(1d)] -2.32 2.32</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 1</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;0&quot; &quot;1&quot;</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</span>

<span class="co"># 获取卡方值</span>
chi_res<span class="op">$</span>statistic
<span class="co">#&gt; X-squared </span>
<span class="co">#&gt;  5.377778</span>

<span class="co"># 获取p值</span>
chi_res<span class="op">$</span>p.value
<span class="co">#&gt; [1] 0.02039484</span></code></pre></div>
</div>
<div id="section-0.46.2.1.2" class="section level5">
<h5><span class="header-section-number">0.46.2.1.2</span> 精确二项检验</h5>
<p>精确二项检验仅能用于存在两个值的单变量数据。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct &lt;-<span class="st"> </span><span class="kw">table</span>(data<span class="op">$</span>result)
ct
<span class="co">#&gt; </span>
<span class="co">#&gt;  0  1 </span>
<span class="co">#&gt; 17 13</span>

<span class="kw">binom.test</span>(ct, <span class="dt">p=</span><span class="fl">0.5</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Exact binomial test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; number of successes = 17, number of trials = 30, p-value = 0.5847</span>
<span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.5</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.3742735 0.7453925</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; probability of success </span>
<span class="co">#&gt;              0.5666667</span>


<span class="co"># 使用75%的期望概率——注意1在第二列，所以只需要令p=0.25</span>
<span class="kw">binom.test</span>(ct, <span class="dt">p=</span><span class="fl">0.25</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Exact binomial test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; number of successes = 17, number of trials = 30, p-value = 0.0002157</span>
<span class="co">#&gt; alternative hypothesis: true probability of success is not equal to 0.25</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.3742735 0.7453925</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; probability of success </span>
<span class="co">#&gt;              0.5666667</span></code></pre></div>
<p>如果你想要从检验结果中提取信息，可以将结果保存进一个变量，然后用<code>str()</code>函数查看变量信息，接着把你想要的部分取出来。例如：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bin_res &lt;-<span class="st"> </span><span class="kw">binom.test</span>(ct, <span class="dt">p=</span><span class="fl">0.25</span>)
<span class="co"># View all the parts that can be extracted</span>
<span class="kw">str</span>(bin_res)
<span class="co">#&gt; List of 9</span>
<span class="co">#&gt;  $ statistic  : Named num 17</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;number of successes&quot;</span>
<span class="co">#&gt;  $ parameter  : Named num 30</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;number of trials&quot;</span>
<span class="co">#&gt;  $ p.value    : Named num 0.000216</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;0&quot;</span>
<span class="co">#&gt;  $ conf.int   : atomic [1:2] 0.374 0.745</span>
<span class="co">#&gt;   ..- attr(*, &quot;conf.level&quot;)= num 0.95</span>
<span class="co">#&gt;  $ estimate   : Named num 0.567</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;probability of success&quot;</span>
<span class="co">#&gt;  $ null.value : Named num 0.25</span>
<span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr &quot;probability of success&quot;</span>
<span class="co">#&gt;  $ alternative: chr &quot;two.sided&quot;</span>
<span class="co">#&gt;  $ method     : chr &quot;Exact binomial test&quot;</span>
<span class="co">#&gt;  $ data.name  : chr &quot;ct&quot;</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</span>

<span class="co"># 获取p值</span>
bin_res<span class="op">$</span>p.value
<span class="co">#&gt;            0 </span>
<span class="co">#&gt; 0.0002156938</span>

<span class="co"># 获取95%置信区间</span>
bin_res<span class="op">$</span>conf.int
<span class="co">#&gt; [1] 0.3742735 0.7453925</span>
<span class="co">#&gt; attr(,&quot;conf.level&quot;)</span>
<span class="co">#&gt; [1] 0.95</span></code></pre></div>
</div>
</div>
<div id="section-0.46.2.2" class="section level4">
<h4><span class="header-section-number">0.46.2.2</span> 独立检验（比较组间）</h4>
<div id="-1" class="section level5">
<h5><span class="header-section-number">0.46.2.2.1</span> 卡方检验</h5>
<p>想要检验控制和处理组结果的频数差异，使用2维列联表。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct &lt;-<span class="st"> </span><span class="kw">table</span>(data<span class="op">$</span>condition, data<span class="op">$</span>result)
ct
<span class="co">#&gt;            </span>
<span class="co">#&gt;              0  1</span>
<span class="co">#&gt;   control   11  3</span>
<span class="co">#&gt;   treatment  6 10</span>

<span class="kw">chisq.test</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; X-squared = 3.593, df = 1, p-value = 0.05802</span>

<span class="kw">chisq.test</span>(ct, <span class="dt">correct=</span><span class="ot">FALSE</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Pearson&#39;s Chi-squared test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; X-squared = 5.1293, df = 1, p-value = 0.02353</span></code></pre></div>
</div>
<div id="fisher" class="section level5">
<h5><span class="header-section-number">0.46.2.2.2</span> Fisher精确检验</h5>
<p>对于小样本而言Fisher精确检验更为适合。小样本的2x2列表非常典型，样本更多、更复杂的列表计算强度非常大。当然，用R进行比较复杂的计算也是没有太大问题的。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct &lt;-<span class="st"> </span><span class="kw">table</span>(data<span class="op">$</span>condition, data<span class="op">$</span>result)
ct
<span class="co">#&gt;            </span>
<span class="co">#&gt;              0  1</span>
<span class="co">#&gt;   control   11  3</span>
<span class="co">#&gt;   treatment  6 10</span>

<span class="kw">fisher.test</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fisher&#39;s Exact Test for Count Data</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; p-value = 0.03293</span>
<span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;   0.966861 45.555016</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; odds ratio </span>
<span class="co">#&gt;   5.714369</span></code></pre></div>
</div>
<div id="cochran-mantel-haenszel-test" class="section level5">
<h5><span class="header-section-number">0.46.2.2.3</span> Cochran-Mantel-Haenszel test</h5>
<p>Cochran-Mantel-Haenszel 检验 （或称为 Mantel-Haenszel 检验)）用于检验重复测量两离散变量的独立性。通常使用 2x2xK列表表示，K是测量条件的次数。比如你想要指导是否一个处理（C vs. D）是否影响了恢复的概率（yes or no）。假设该处理一天监控测量三次——早上、中午和晚上，而你想要你的检验能够控制它。那么你可以使用CMH检验对2x2x3列联表进行操作，第三个变量是你想要控制的变量。</p>
<p>R中的CMH检验可以处理比2x2xK维度更高的数据，例如你处理3x3xK列联表。</p>
<p>在接下来的例子里有三个变量：Location，Allele和Habitat。问题是——当控制location变量时，Allel（94或非94）和Habitat（marine或estuarine）两个变量是否独立。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fish &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="st">&#39;</span>
<span class="st">  Location Allele   Habitat Count</span>
<span class="st"> tillamook     94    marine    56</span>
<span class="st"> tillamook     94 estuarine    69</span>
<span class="st"> tillamook non-94    marine    40</span>
<span class="st"> tillamook non-94 estuarine    77</span>
<span class="st">   yaquina     94    marine    61</span>
<span class="st">   yaquina     94 estuarine   257</span>
<span class="st">   yaquina non-94    marine    57</span>
<span class="st">   yaquina non-94 estuarine   301</span>
<span class="st">     alsea     94    marine    73</span>
<span class="st">     alsea     94 estuarine    65</span>
<span class="st">     alsea non-94    marine    71</span>
<span class="st">     alsea non-94 estuarine    79</span>
<span class="st">    umpqua     94    marine    71</span>
<span class="st">    umpqua     94 estuarine    48</span>
<span class="st">    umpqua non-94    marine    55</span>
<span class="st">    umpqua non-94 estuarine    48</span>
<span class="st">&#39;</span>)</code></pre></div>
<p>注意上面的数据是<strong>计数</strong>的数据框，而不是像之前的例子是<strong>记录</strong>的数据框。这里我们使用<code>xtabs()</code>函数将它转换为列联表。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 制造一个3维的列联表，最后一个变量时要控制的Location变量</span>
ct &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Allele <span class="op">+</span><span class="st"> </span>Habitat <span class="op">+</span><span class="st"> </span>Location, <span class="dt">data=</span>fish)
ct
<span class="co">#&gt; , , Location = alsea</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Habitat</span>
<span class="co">#&gt; Allele   estuarine marine</span>
<span class="co">#&gt;   94            65     73</span>
<span class="co">#&gt;   non-94        79     71</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , Location = tillamook</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Habitat</span>
<span class="co">#&gt; Allele   estuarine marine</span>
<span class="co">#&gt;   94            69     56</span>
<span class="co">#&gt;   non-94        77     40</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , Location = umpqua</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Habitat</span>
<span class="co">#&gt; Allele   estuarine marine</span>
<span class="co">#&gt;   94            48     71</span>
<span class="co">#&gt;   non-94        48     55</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; , , Location = yaquina</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;         Habitat</span>
<span class="co">#&gt; Allele   estuarine marine</span>
<span class="co">#&gt;   94           257     61</span>
<span class="co">#&gt;   non-94       301     57</span>

<span class="co"># This prints ct in a &quot;flat&quot; format</span>
<span class="kw">ftable</span>(ct)
<span class="co">#&gt;                  Location alsea tillamook umpqua yaquina</span>
<span class="co">#&gt; Allele Habitat                                          </span>
<span class="co">#&gt; 94     estuarine             65        69     48     257</span>
<span class="co">#&gt;        marine                73        56     71      61</span>
<span class="co">#&gt; non-94 estuarine             79        77     48     301</span>
<span class="co">#&gt;        marine                71        40     55      57</span>

<span class="co"># 按指定方式进行变量输出</span>
<span class="kw">ftable</span>(ct, <span class="dt">row.vars=</span><span class="kw">c</span>(<span class="st">&quot;Location&quot;</span>,<span class="st">&quot;Allele&quot;</span>), <span class="dt">col.vars=</span><span class="st">&quot;Habitat&quot;</span>)
<span class="co">#&gt;                  Habitat estuarine marine</span>
<span class="co">#&gt; Location  Allele                         </span>
<span class="co">#&gt; alsea     94                    65     73</span>
<span class="co">#&gt;           non-94                79     71</span>
<span class="co">#&gt; tillamook 94                    69     56</span>
<span class="co">#&gt;           non-94                77     40</span>
<span class="co">#&gt; umpqua    94                    48     71</span>
<span class="co">#&gt;           non-94                48     55</span>
<span class="co">#&gt; yaquina   94                   257     61</span>
<span class="co">#&gt;           non-94               301     57</span>


<span class="kw">mantelhaen.test</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Mantel-Haenszel chi-squared test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</span>
<span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.6005522 0.9593077</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; common odds ratio </span>
<span class="co">#&gt;          0.759022</span></code></pre></div>
<p>根据检验结果，当控制Location变量时Allele与Habitat变量存在相关（p=.025）。</p>
<p>注意列联表的前两个维度处理是一致的，所以前后顺序变化都不会影响结果。而最后一个变量变化会导致结果的不同，下面是一个实例。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 下面两个看似不同的列联表，实际检验结果相同</span>
ct.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Habitat <span class="op">+</span><span class="st"> </span>Allele <span class="op">+</span><span class="st"> </span>Location, <span class="dt">data=</span>fish)
ct.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Allele <span class="op">+</span><span class="st"> </span>Habitat <span class="op">+</span><span class="st"> </span>Location, <span class="dt">data=</span>fish)
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">1</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Mantel-Haenszel chi-squared test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.1</span>
<span class="co">#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</span>
<span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.6005522 0.9593077</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; common odds ratio </span>
<span class="co">#&gt;          0.759022</span>
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">2</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Mantel-Haenszel chi-squared test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.2</span>
<span class="co">#&gt; Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463</span>
<span class="co">#&gt; alternative hypothesis: true common odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;  0.6005522 0.9593077</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; common odds ratio </span>
<span class="co">#&gt;          0.759022</span>


<span class="co"># 把Allele放到最后，结果不同了</span>
ct.<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Location <span class="op">+</span><span class="st"> </span>Habitat <span class="op">+</span><span class="st"> </span>Allele, <span class="dt">data=</span>fish)
ct.<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Habitat <span class="op">+</span><span class="st"> </span>Location <span class="op">+</span><span class="st"> </span>Allele, <span class="dt">data=</span>fish)
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">3</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Cochran-Mantel-Haenszel test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.3</span>
<span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 168.47, df = 3, p-value &lt; 2.2e-16</span>
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">4</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Cochran-Mantel-Haenszel test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.4</span>
<span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 168.47, df = 3, p-value &lt; 2.2e-16</span>


<span class="co"># 把Habitat放最后，结果也不同</span>
ct.<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Allele <span class="op">+</span><span class="st"> </span>Location <span class="op">+</span><span class="st"> </span>Habitat, <span class="dt">data=</span>fish)
ct.<span class="dv">6</span> &lt;-<span class="st"> </span><span class="kw">xtabs</span>(Count <span class="op">~</span><span class="st"> </span>Location <span class="op">+</span><span class="st"> </span>Allele <span class="op">+</span><span class="st"> </span>Habitat, <span class="dt">data=</span>fish)
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">5</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Cochran-Mantel-Haenszel test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.5</span>
<span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689</span>
<span class="kw">mantelhaen.test</span>(ct.<span class="dv">6</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Cochran-Mantel-Haenszel test</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct.6</span>
<span class="co">#&gt; Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689</span></code></pre></div>
</div>
</div>
<div id="mcnemar" class="section level4">
<h4><span class="header-section-number">0.46.2.3</span> McNemar检验</h4>
<p>McNemar检验概念上是频数数据的一个被试内检验。例如，假设你想要检验是否一个处理增加了一个人对某个问题反应“yes”的概率，而且你只有每个人处理前和处理后的数据。标准的卡方检验将不合适，因为它假设了组别是独立的。取而代之，我们可以使用McNemar检验。该检验仅适用于当存在一个独立变量的两次测量时。用于McNemar的列联表与用于卡方检验的非常相似，但结构上是不同的。</p>
<p>假设你有下面的数据。每个对象有处理前和后的反应。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="st">&#39;</span>
<span class="st"> subject time result</span>
<span class="st">       1  pre      0</span>
<span class="st">       1 post      1</span>
<span class="st">       2  pre      1</span>
<span class="st">       2 post      1</span>
<span class="st">       3  pre      0</span>
<span class="st">       3 post      1</span>
<span class="st">       4  pre      1</span>
<span class="st">       4 post      0</span>
<span class="st">       5  pre      1</span>
<span class="st">       5 post      1</span>
<span class="st">       6  pre      0</span>
<span class="st">       6 post      1</span>
<span class="st">       7  pre      0</span>
<span class="st">       7 post      1</span>
<span class="st">       8  pre      0</span>
<span class="st">       8 post      1</span>
<span class="st">       9  pre      0</span>
<span class="st">       9 post      1</span>
<span class="st">      10  pre      1</span>
<span class="st">      10 post      1</span>
<span class="st">      11  pre      0</span>
<span class="st">      11 post      0</span>
<span class="st">      12  pre      1</span>
<span class="st">      12 post      1</span>
<span class="st">      13  pre      0</span>
<span class="st">      13 post      1</span>
<span class="st">      14  pre      0</span>
<span class="st">      14 post      0</span>
<span class="st">      15  pre      0</span>
<span class="st">      15 post      1</span>
<span class="st">&#39;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)

data_wide &lt;-<span class="st"> </span><span class="kw">spread</span>(data, time, result)
data_wide
<span class="co">#&gt;    subject post pre</span>
<span class="co">#&gt; 1        1    1   0</span>
<span class="co">#&gt; 2        2    1   1</span>
<span class="co">#&gt; 3        3    1   0</span>
<span class="co">#&gt; 4        4    0   1</span>
<span class="co">#&gt; 5        5    1   1</span>
<span class="co">#&gt; 6        6    1   0</span>
<span class="co">#&gt; 7        7    1   0</span>
<span class="co">#&gt; 8        8    1   0</span>
<span class="co">#&gt; 9        9    1   0</span>
<span class="co">#&gt; 10      10    1   1</span>
<span class="co">#&gt; 11      11    0   0</span>
<span class="co">#&gt; 12      12    1   1</span>
<span class="co">#&gt; 13      13    1   0</span>
<span class="co">#&gt; 14      14    0   0</span>
<span class="co">#&gt; 15      15    1   0</span></code></pre></div>
<p>接下来从数据框的pre和post列生成列联表：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct &lt;-<span class="st"> </span><span class="kw">table</span>( data_wide[,<span class="kw">c</span>(<span class="st">&quot;pre&quot;</span>,<span class="st">&quot;post&quot;</span>)] )
ct
<span class="co">#&gt;    post</span>
<span class="co">#&gt; pre 0 1</span>
<span class="co">#&gt;   0 2 8</span>
<span class="co">#&gt;   1 1 4</span>

<span class="co"># 下面是用于标准卡方检验的列联表，注意差别喔</span>

<span class="co"># table(data[,c(&quot;time&quot;,&quot;result&quot;)])</span>
<span class="co">#       result</span>
<span class="co"># time    0  1</span>
<span class="co">#   post  3 12</span>
<span class="co">#   pre  10  5</span></code></pre></div>
<p>执行检验：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mcnemar.test</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  McNemar&#39;s Chi-squared test with continuity correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; McNemar&#39;s chi-squared = 4, df = 1, p-value = 0.0455</span></code></pre></div>
<p>对于小样本，它会使用连续校正。我们可以使用<strong>精确</strong>校正的McNemar检验替换这种校正方式，前者更加的精确，可通过<code>exact2x2</code>包获取。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(exact2x2)
<span class="co">#&gt; Loading required package: exactci</span>
<span class="co">#&gt; Loading required package: ssanv</span>
<span class="kw">mcnemar.exact</span>(ct)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Exact McNemar test (with central confidence intervals)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  ct</span>
<span class="co">#&gt; b = 8, c = 1, p-value = 0.03906</span>
<span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span>
<span class="co">#&gt; 95 percent confidence interval:</span>
<span class="co">#&gt;    1.072554 354.981246</span>
<span class="co">#&gt; sample estimates:</span>
<span class="co">#&gt; odds ratio </span>
<span class="co">#&gt;          8</span></code></pre></div>
</div>
</div>
</div>
<div id="anova" class="section level2">
<h2><span class="header-section-number">0.47</span> ANOVA</h2>
<div id="-46" class="section level3">
<h3><span class="header-section-number">0.47.1</span> 问题</h3>
<p>你想要使用ANOVA比较多组之间的差异。</p>
</div>
<div id="-42" class="section level3">
<h3><span class="header-section-number">0.47.2</span> 方案</h3>
<p>假设这是你的数据：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="st">&#39;</span>
<span class="st"> subject sex   age before after</span>
<span class="st">       1   F   old    9.5   7.1</span>
<span class="st">       2   M   old   10.3  11.0</span>
<span class="st">       3   M   old    7.5   5.8</span>
<span class="st">       4   F   old   12.4   8.8</span>
<span class="st">       5   M   old   10.2   8.6</span>
<span class="st">       6   M   old   11.0   8.0</span>
<span class="st">       7   M young    9.1   3.0</span>
<span class="st">       8   F young    7.9   5.2</span>
<span class="st">       9   F   old    6.6   3.4</span>
<span class="st">      10   M young    7.7   4.0</span>
<span class="st">      11   M young    9.4   5.3</span>
<span class="st">      12   M   old   11.6  11.3</span>
<span class="st">      13   M young    9.9   4.6</span>
<span class="st">      14   F young    8.6   6.4</span>
<span class="st">      15   F young   14.3  13.5</span>
<span class="st">      16   F   old    9.2   4.7</span>
<span class="st">      17   M young    9.8   5.1</span>
<span class="st">      18   F   old    9.9   7.3</span>
<span class="st">      19   F young   13.0   9.5</span>
<span class="st">      20   M young   10.2   5.4</span>
<span class="st">      21   M young    9.0   3.7</span>
<span class="st">      22   F young    7.9   6.2</span>
<span class="st">      23   M   old   10.1  10.0</span>
<span class="st">      24   M young    9.0   1.7</span>
<span class="st">      25   M young    8.6   2.9</span>
<span class="st">      26   M young    9.4   3.2</span>
<span class="st">      27   M young    9.7   4.7</span>
<span class="st">      28   M young    9.3   4.9</span>
<span class="st">      29   F young   10.7   9.8</span>
<span class="st">      30   M   old    9.3   9.4</span>
<span class="st">&#39;</span>)

<span class="co"># 确保subject列是一个因子变量，这样不会当作连续变量对待</span>
data<span class="op">$</span>subject &lt;-<span class="st"> </span><span class="kw">factor</span>(data<span class="op">$</span>subject)</code></pre></div>
<div id="anova" class="section level4">
<h4><span class="header-section-number">0.47.2.1</span> 单因素ANOVA分析</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 单因素：</span>
<span class="co"># 独立变量: sex</span>
<span class="co"># 依赖变量: before</span>
aov1 &lt;-<span class="st"> </span><span class="kw">aov</span>(before <span class="op">~</span><span class="st"> </span>sex, <span class="dt">data=</span>data)
<span class="kw">summary</span>(aov1)
<span class="co">#&gt;             Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; sex          1   1.53   1.529   0.573  0.455</span>
<span class="co">#&gt; Residuals   28  74.70   2.668</span>

<span class="co"># 显示均值</span>
<span class="kw">model.tables</span>(aov1, <span class="st">&quot;means&quot;</span>)
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;          </span>
<span class="co">#&gt; 9.703333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  sex </span>
<span class="co">#&gt;      F      M</span>
<span class="co">#&gt;     10  9.532</span>
<span class="co">#&gt; rep 11 19.000</span></code></pre></div>
</div>
<div id="anova" class="section level4">
<h4><span class="header-section-number">0.47.2.2</span> 双因素ANOVA分析</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 2x2 between:</span>
<span class="co"># 独立变量: sex</span>
<span class="co"># 独立变量 age</span>
<span class="co"># 依赖变量: after</span>
<span class="co"># 下面两种调用方式等价：</span>
aov2 &lt;-<span class="st"> </span><span class="kw">aov</span>(after <span class="op">~</span><span class="st"> </span>sex<span class="op">*</span>age, <span class="dt">data=</span>data)
aov2 &lt;-<span class="st"> </span><span class="kw">aov</span>(after <span class="op">~</span><span class="st"> </span>sex <span class="op">+</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>sex<span class="op">:</span>age, <span class="dt">data=</span>data)
<span class="kw">summary</span>(aov2)
<span class="co">#&gt;             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span>
<span class="co">#&gt; sex          1  16.08   16.08   4.038  0.0550 .  </span>
<span class="co">#&gt; age          1  38.96   38.96   9.786  0.0043 ** </span>
<span class="co">#&gt; sex:age      1  89.61   89.61  22.509 6.6e-05 ***</span>
<span class="co">#&gt; Residuals   26 103.51    3.98                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>

<span class="co"># 显示均值</span>
<span class="kw">model.tables</span>(aov2, <span class="st">&quot;means&quot;</span>)
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;          </span>
<span class="co">#&gt; 6.483333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  sex </span>
<span class="co">#&gt;          F      M</span>
<span class="co">#&gt;      7.445  5.926</span>
<span class="co">#&gt; rep 11.000 19.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  age </span>
<span class="co">#&gt;        old  young</span>
<span class="co">#&gt;      7.874  5.556</span>
<span class="co">#&gt; rep 12.000 18.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  sex:age </span>
<span class="co">#&gt;      age</span>
<span class="co">#&gt; sex   old    young </span>
<span class="co">#&gt;   F    6.260  8.433</span>
<span class="co">#&gt;   rep  5.000  6.000</span>
<span class="co">#&gt;   M    9.157  4.042</span>
<span class="co">#&gt;   rep  7.000 12.000</span></code></pre></div>
</div>
<div id="tukey-hsd-post-hoc-" class="section level4">
<h4><span class="header-section-number">0.47.2.3</span> Tukey HSD post-hoc 检验</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">TukeyHSD</span>(aov2)
<span class="co">#&gt;   Tukey multiple comparisons of means</span>
<span class="co">#&gt;     95% family-wise confidence level</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Fit: aov(formula = after ~ sex + age + sex:age, data = data)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sex</span>
<span class="co">#&gt;          diff       lwr        upr     p adj</span>
<span class="co">#&gt; M-F -1.519139 -3.073025 0.03474709 0.0549625</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $age</span>
<span class="co">#&gt;               diff       lwr        upr     p adj</span>
<span class="co">#&gt; young-old -2.31785 -3.846349 -0.7893498 0.0044215</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`sex:age`</span>
<span class="co">#&gt;                       diff        lwr        upr     p adj</span>
<span class="co">#&gt; M:old-F:old      2.8971429 -0.3079526  6.1022384 0.0869856</span>
<span class="co">#&gt; F:young-F:old    2.1733333 -1.1411824  5.4878491 0.2966111</span>
<span class="co">#&gt; M:young-F:old   -2.2183333 -5.1319553  0.6952887 0.1832890</span>
<span class="co">#&gt; F:young-M:old   -0.7238095 -3.7691188  2.3214997 0.9138789</span>
<span class="co">#&gt; M:young-M:old   -5.1154762 -7.7187601 -2.5121923 0.0000676</span>
<span class="co">#&gt; M:young-F:young -4.3916667 -7.1285380 -1.6547953 0.0008841</span></code></pre></div>
</div>
</div>
<div id="anovas" class="section level3">
<h3><span class="header-section-number">0.47.3</span> 有受试内变量的ANOVAs</h3>
<p>对于有受试内变量的ANOVA分析，数据必须满足为长格式。上面提到的数据都是宽格式，所以我们需要先转换数据格式（参见[长宽格式互相转换]</p>
<p>同样地，有受试内变量的ANOVA分析需要一个识别列。当前数据里是<code>subject</code>列。<strong>识别变量必须是一个因子</strong>，如果是数值类型，函数会解析错误导致不能正常工作。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr)

<span class="co"># 原始数据</span>
<span class="co"># subject sex   age before after</span>
<span class="co">#       1   F   old    9.5   7.1</span>
<span class="co">#       2   M   old   10.3  11.0</span>
<span class="co">#       3   M   old    7.5   5.8</span>

<span class="co"># 转换为长格式</span>
data_long &lt;-<span class="st"> </span><span class="kw">gather</span>(data, time, value, before<span class="op">:</span>after)
<span class="co"># Look at first few rows</span>
<span class="kw">head</span>(data_long)
<span class="co">#&gt;   subject sex age   time value</span>
<span class="co">#&gt; 1       1   F old before   9.5</span>
<span class="co">#&gt; 2       2   M old before  10.3</span>
<span class="co">#&gt; 3       3   M old before   7.5</span>
<span class="co">#&gt; 4       4   F old before  12.4</span>
<span class="co">#&gt; 5       5   M old before  10.2</span>
<span class="co">#&gt; 6       6   M old before  11.0</span>


<span class="co"># 确保subject列是一个因子</span>
data_long<span class="op">$</span>subject &lt;-<span class="st"> </span><span class="kw">factor</span>(data_long<span class="op">$</span>subject)</code></pre></div>
<div id="one-way-within-anova" class="section level4">
<h4><span class="header-section-number">0.47.3.1</span> One-way within ANOVA</h4>
<p>首先，像上面展示的一样将数据从宽格式转换到长格式并确保<code>subject</code>列是因子变量。如果<code>subject</code>是数值向量，而不是因子，你的结果将会出错。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 独立变量 (within): time</span>
<span class="co"># 依赖变量:          value</span>
aov_time &lt;-<span class="st"> </span><span class="kw">aov</span>(value <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>time), <span class="dt">data=</span>data_long)
<span class="kw">summary</span>(aov_time)
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: subject</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; Residuals 29  261.2   9.009               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: subject:time</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">#&gt; time       1 155.53  155.53   71.43 2.59e-09 ***</span>
<span class="co">#&gt; Residuals 29  63.14    2.18                     </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>


<span class="co"># This won&#39;t work here for some reason (?)</span>
<span class="kw">model.tables</span>(aov_time, <span class="st">&quot;means&quot;</span>)
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;          </span>
<span class="co">#&gt; 8.093333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  time </span>
<span class="co">#&gt; time</span>
<span class="co">#&gt;  after before </span>
<span class="co">#&gt;  6.483  9.703</span></code></pre></div>
</div>
<div id="-anova" class="section level4">
<h4><span class="header-section-number">0.47.3.2</span> 混合设计 ANOVA</h4>
<p>首先，像上面展示的一样将数据从宽格式转换到长格式并确保<code>subject</code>列是因子变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 2x2 mixed:</span>
<span class="co"># 独立变量（被试间） : age</span>
<span class="co"># 独立变量（被试内） :  time</span>
<span class="co"># 依赖变量:         value</span>
aov_age_time &lt;-<span class="st"> </span><span class="kw">aov</span>(value <span class="op">~</span><span class="st"> </span>age<span class="op">*</span>time <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>time), <span class="dt">data=</span>data_long)
<span class="kw">summary</span>(aov_age_time)
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: subject</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co">#&gt; age        1  24.44  24.440    2.89    0.1</span>
<span class="co">#&gt; Residuals 28 236.81   8.457               </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Error: subject:time</span>
<span class="co">#&gt;           Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">#&gt; time       1 155.53  155.53   98.14 1.18e-10 ***</span>
<span class="co">#&gt; age:time   1  18.77   18.77   11.84  0.00184 ** </span>
<span class="co">#&gt; Residuals 28  44.37    1.58                     </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>

<span class="co"># This won&#39;t work here because the data is unbalanced</span>
<span class="kw">model.tables</span>(aov_age_time, <span class="st">&quot;means&quot;</span>)
<span class="co">#&gt; Tables of means</span>
<span class="co">#&gt; Grand mean</span>
<span class="co">#&gt;          </span>
<span class="co">#&gt; 8.093333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  age </span>
<span class="co">#&gt;        old  young</span>
<span class="co">#&gt;      8.875  7.572</span>
<span class="co">#&gt; rep 24.000 36.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  time </span>
<span class="co">#&gt;      after before</span>
<span class="co">#&gt;      6.483  9.703</span>
<span class="co">#&gt; rep 30.000 30.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  age:time </span>
<span class="co">#&gt;        time</span>
<span class="co">#&gt; age     after  before</span>
<span class="co">#&gt;   old    7.950  9.800</span>
<span class="co">#&gt;   rep   12.000 12.000</span>
<span class="co">#&gt;   young  5.506  9.639</span>
<span class="co">#&gt;   rep   18.000 18.000</span></code></pre></div>
</div>
<div id="anova" class="section level4">
<h4><span class="header-section-number">0.47.3.3</span> 更多被试内变量的ANOVA</h4>
<p>下面这些例子使用的不是上面的数据，但可以解释怎么进行相应的处理。首先，像上面展示的一样将数据从宽格式转换到长格式并确保<code>subject</code>列是因子变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 两个被试内变量</span>
aov.ww &lt;-<span class="st"> </span><span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>w1<span class="op">*</span>w2 <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(w1<span class="op">*</span>w2)), <span class="dt">data=</span>data_long)

<span class="co"># 1个被试间变量，两个被试内变量</span>
aov.bww &lt;-<span class="st"> </span><span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>b1<span class="op">*</span>w1<span class="op">*</span>w2 <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(w1<span class="op">*</span>w2)) <span class="op">+</span><span class="st"> </span>b1, <span class="dt">data=</span>data_long)

<span class="co"># 两个被试间变量，一个被试内变量</span>
aov.bww &lt;-<span class="st"> </span><span class="kw">aov</span>(y <span class="op">~</span><span class="st"> </span>b1<span class="op">*</span>b2<span class="op">*</span>w1 <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(subject<span class="op">/</span>(w1)) <span class="op">+</span><span class="st"> </span>b1<span class="op">*</span>b2, <span class="dt">data=</span>data_long)</code></pre></div>
</div>
</div>
</div>
<div id="section-0.48" class="section level2">
<h2><span class="header-section-number">0.48</span> 逻辑回归</h2>
<div id="-47" class="section level3">
<h3><span class="header-section-number">0.48.1</span> 问题</h3>
<p>你想要运用逻辑回归分析。</p>
</div>
<div id="-43" class="section level3">
<h3><span class="header-section-number">0.48.2</span> 方案</h3>
<p>逻辑回归典型使用于当存在一个离散的响应变量（比如赢和输）和一个与响应变量（也称为结果变量、因变量）的概率或几率相关联的连续预测变量的情况。它也适用于有多个预测变量的分类预测。</p>
<p>假设我们从内置的<code>mtcars</code>数据集的一部分开始，像下面这样，我们将<code>vs</code>作为响应变量，<code>mpg</code>作为一个连续的预测变量，<code>am</code>作为一个分类（离散）的预测变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(mtcars)
dat &lt;-<span class="st"> </span><span class="kw">subset</span>(mtcars, <span class="dt">select=</span><span class="kw">c</span>(mpg, am, vs))
dat
<span class="co">#&gt;                      mpg am vs</span>
<span class="co">#&gt; Mazda RX4           21.0  1  0</span>
<span class="co">#&gt; Mazda RX4 Wag       21.0  1  0</span>
<span class="co">#&gt; Datsun 710          22.8  1  1</span>
<span class="co">#&gt; Hornet 4 Drive      21.4  0  1</span>
<span class="co">#&gt; Hornet Sportabout   18.7  0  0</span>
<span class="co">#&gt; Valiant             18.1  0  1</span>
<span class="co">#&gt; Duster 360          14.3  0  0</span>
<span class="co">#&gt; Merc 240D           24.4  0  1</span>
<span class="co">#&gt; Merc 230            22.8  0  1</span>
<span class="co">#&gt; Merc 280            19.2  0  1</span>
<span class="co">#&gt; Merc 280C           17.8  0  1</span>
<span class="co">#&gt; Merc 450SE          16.4  0  0</span>
<span class="co">#&gt; Merc 450SL          17.3  0  0</span>
<span class="co">#&gt; Merc 450SLC         15.2  0  0</span>
<span class="co">#&gt; Cadillac Fleetwood  10.4  0  0</span>
<span class="co">#&gt; Lincoln Continental 10.4  0  0</span>
<span class="co">#&gt; Chrysler Imperial   14.7  0  0</span>
<span class="co">#&gt; Fiat 128            32.4  1  1</span>
<span class="co">#&gt; Honda Civic         30.4  1  1</span>
<span class="co">#&gt; Toyota Corolla      33.9  1  1</span>
<span class="co">#&gt; Toyota Corona       21.5  0  1</span>
<span class="co">#&gt; Dodge Challenger    15.5  0  0</span>
<span class="co">#&gt; AMC Javelin         15.2  0  0</span>
<span class="co">#&gt; Camaro Z28          13.3  0  0</span>
<span class="co">#&gt; Pontiac Firebird    19.2  0  0</span>
<span class="co">#&gt; Fiat X1-9           27.3  1  1</span>
<span class="co">#&gt; Porsche 914-2       26.0  1  0</span>
<span class="co">#&gt; Lotus Europa        30.4  1  1</span>
<span class="co">#&gt; Ford Pantera L      15.8  1  0</span>
<span class="co">#&gt; Ferrari Dino        19.7  1  0</span>
<span class="co">#&gt; Maserati Bora       15.0  1  0</span>
<span class="co">#&gt; Volvo 142E          21.4  1  1</span></code></pre></div>
<div id="section-0.48.2.1" class="section level4">
<h4><span class="header-section-number">0.48.2.1</span> 连续预测变量，离散响应变量</h4>
<p>如果数据集有一个离散变量和一个连续变量，并且连续变量离散变量概率的预测器（就像直线回归中x可以预测y一样，只不过是两个连续变量，而逻辑回归中被预测的是离散变量），逻辑回归可能适用。</p>
<p>下面例子中，<code>mpg</code>是连续预测变量，<code>vs</code>是离散响应变量。.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 执行逻辑回归 —— 下面两种方式等效</span>
<span class="co"># logit是二项分布家族的默认模型</span>
logr_vm &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>mpg, <span class="dt">data=</span>dat, <span class="dt">family=</span>binomial)
logr_vm &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>mpg, <span class="dt">data=</span>dat, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span><span class="st">&quot;logit&quot;</span>))</code></pre></div>
<p>查看模型信息：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 输出模型信息</span>
logr_vm
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glm(formula = vs ~ mpg, family = binomial(link = &quot;logit&quot;), data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)          mpg  </span>
<span class="co">#&gt;     -8.8331       0.4304  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  30 Residual</span>
<span class="co">#&gt; Null Deviance:       43.86 </span>
<span class="co">#&gt; Residual Deviance: 25.53     AIC: 29.53</span>

<span class="co"># More information about the model</span>
<span class="kw">summary</span>(logr_vm)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = vs ~ mpg, family = binomial(link = &quot;logit&quot;), data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -2.2127  -0.5121  -0.2276   0.6402   1.6980  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   </span>
<span class="co">#&gt; (Intercept)  -8.8331     3.1623  -2.793  0.00522 **</span>
<span class="co">#&gt; mpg           0.4304     0.1584   2.717  0.00659 **</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 25.533  on 30  degrees of freedom</span>
<span class="co">#&gt; AIC: 29.533</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></code></pre></div>
<div id="section-0.48.2.1.1" class="section level5">
<h5><span class="header-section-number">0.48.2.1.1</span> 画图</h5>
<p>我们可以使用<code>ggplot2</code>或者基本图形绘制数据和逻辑回归结果。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>mpg, <span class="dt">y=</span>vs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="dt">se=</span><span class="ot">FALSE</span>)

<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># 减少一些边缘使得图形显示更好些</span>
<span class="kw">plot</span>(dat<span class="op">$</span>mpg, dat<span class="op">$</span>vs)
<span class="kw">curve</span>(<span class="kw">predict</span>(logr_vm, <span class="kw">data.frame</span>(<span class="dt">mpg=</span>x), <span class="dt">type=</span><span class="st">&quot;response&quot;</span>), <span class="dt">add=</span><span class="ot">TRUE</span>) </code></pre></div>
</div>
</div>
<div id="section-0.48.2.2" class="section level4">
<h4><span class="header-section-number">0.48.2.2</span> 离散预测变量，离散响应变量</h4>
<p>这个跟上面的操作大致相同，<code>am</code>是一个离散的预测变量，<code>vs</code>是一个离散的响应变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 执行逻辑回归</span>
logr_va &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>am, <span class="dt">data=</span>dat, <span class="dt">family=</span>binomial)

<span class="co"># 打印模型信息</span>
logr_va
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glm(formula = vs ~ am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)           am  </span>
<span class="co">#&gt;     -0.5390       0.6931  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  30 Residual</span>
<span class="co">#&gt; Null Deviance:       43.86 </span>
<span class="co">#&gt; Residual Deviance: 42.95     AIC: 46.95</span>

<span class="co"># More information about the model</span>
<span class="kw">summary</span>(logr_va)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = vs ~ am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;     Min       1Q   Median       3Q      Max  </span>
<span class="co">#&gt; -1.2435  -0.9587  -0.9587   1.1127   1.4132  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="co">#&gt; (Intercept)  -0.5390     0.4756  -1.133    0.257</span>
<span class="co">#&gt; am            0.6931     0.7319   0.947    0.344</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 42.953  on 30  degrees of freedom</span>
<span class="co">#&gt; AIC: 46.953</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></code></pre></div>
<div id="-1" class="section level5">
<h5><span class="header-section-number">0.48.2.2.1</span> 画图</h5>
<p>尽管图形可能会比连续预测变量的信息少，我们还是可以使用<code>ggplot2</code>或者基本图形绘制逻辑数据和回归结果。因为数据点大致在4个位置，我们可以使用抖动点避免叠加。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>am, <span class="dt">y=</span>vs)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>, <span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">width=</span>.<span class="dv">05</span>,<span class="dt">height=</span>.<span class="dv">05</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="dt">se=</span><span class="ot">FALSE</span>)


<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="co"># 减少一些边缘使得图形显示更好些</span>
<span class="kw">plot</span>(<span class="kw">jitter</span>(dat<span class="op">$</span>am, .<span class="dv">2</span>), <span class="kw">jitter</span>(dat<span class="op">$</span>vs, .<span class="dv">2</span>))
<span class="kw">curve</span>(<span class="kw">predict</span>(logr_va, <span class="kw">data.frame</span>(<span class="dt">am=</span>x), <span class="dt">type=</span><span class="st">&quot;response&quot;</span>), <span class="dt">add=</span><span class="ot">TRUE</span>) </code></pre></div>
</div>
</div>
<div id="section-0.48.2.3" class="section level4">
<h4><span class="header-section-number">0.48.2.3</span> 连续和离散预测变量，离散响应变量</h4>
<p>这跟先前的例子相似，这里<code>mpg</code>是连续预测变量，<code>am</code>是离散预测变量，<code>vs</code>是离散响应变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">logr_vma &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>mpg <span class="op">+</span><span class="st"> </span>am, <span class="dt">data=</span>dat, <span class="dt">family=</span>binomial)
logr_vma
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glm(formula = vs ~ mpg + am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)          mpg           am  </span>
<span class="co">#&gt;    -12.7051       0.6809      -3.0073  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  29 Residual</span>
<span class="co">#&gt; Null Deviance:       43.86 </span>
<span class="co">#&gt; Residual Deviance: 20.65     AIC: 26.65</span>

<span class="kw">summary</span>(logr_vma)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = vs ~ mpg + am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span>
<span class="co">#&gt; -2.05888  -0.44544  -0.08765   0.33335   1.68405  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   </span>
<span class="co">#&gt; (Intercept) -12.7051     4.6252  -2.747  0.00602 **</span>
<span class="co">#&gt; mpg           0.6809     0.2524   2.698  0.00697 **</span>
<span class="co">#&gt; am           -3.0073     1.5995  -1.880  0.06009 . </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 20.646  on 29  degrees of freedom</span>
<span class="co">#&gt; AIC: 26.646</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 6</span></code></pre></div>
</div>
<div id="section-0.48.2.4" class="section level4">
<h4><span class="header-section-number">0.48.2.4</span> 有交互项的多个预测变量</h4>
<p>当有多个预测变量时我们可能需要检验交互项。交互项可以单独指定，像<code>a + b + c + a:b + b:c + a:b:c</code>，或者它们可以使用<code>a * b *c</code>自动展开（这两种等效）。如果只是想指定部分可能的交互项，比如<code>a</code>与<code>c</code>有交互项，使用<code>a + b + c + a:c</code>。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 执行逻辑回归，下面两种方式等效</span>
logr_vmai &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>mpg <span class="op">*</span><span class="st"> </span>am, <span class="dt">data=</span>dat, <span class="dt">family=</span>binomial)
logr_vmai &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>mpg <span class="op">+</span><span class="st"> </span>am <span class="op">+</span><span class="st"> </span>mpg<span class="op">:</span>am, <span class="dt">data=</span>dat, <span class="dt">family=</span>binomial)

logr_vmai
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:  glm(formula = vs ~ mpg + am + mpg:am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt; (Intercept)          mpg           am       mpg:am  </span>
<span class="co">#&gt;    -20.4784       1.1084      10.1055      -0.6637  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Degrees of Freedom: 31 Total (i.e. Null);  28 Residual</span>
<span class="co">#&gt; Null Deviance:       43.86 </span>
<span class="co">#&gt; Residual Deviance: 19.12     AIC: 27.12</span>

<span class="kw">summary</span>(logr_vmai)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; glm(formula = vs ~ mpg + am + mpg:am, family = binomial, data = dat)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Deviance Residuals: </span>
<span class="co">#&gt;      Min        1Q    Median        3Q       Max  </span>
<span class="co">#&gt; -1.70566  -0.31124  -0.04817   0.28038   1.55603  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span>
<span class="co">#&gt; (Intercept) -20.4784    10.5525  -1.941   0.0523 .</span>
<span class="co">#&gt; mpg           1.1084     0.5770   1.921   0.0547 .</span>
<span class="co">#&gt; am           10.1055    11.9104   0.848   0.3962  </span>
<span class="co">#&gt; mpg:am       -0.6637     0.6242  -1.063   0.2877  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     Null deviance: 43.860  on 31  degrees of freedom</span>
<span class="co">#&gt; Residual deviance: 19.125  on 28  degrees of freedom</span>
<span class="co">#&gt; AIC: 27.125</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Number of Fisher Scoring iterations: 7</span></code></pre></div>
</div>
</div>
</div>
<div id="section-0.49" class="section level2">
<h2><span class="header-section-number">0.49</span> 变量同质性</h2>
<div id="-48" class="section level3">
<h3><span class="header-section-number">0.49.1</span> 问题</h3>
<p>你想要（精确）检验样本的方差同质性（同方差，方差齐性）。<strong>许多统计检验假设总体同方差</strong>。</p>
</div>
<div id="-44" class="section level3">
<h3><span class="header-section-number">0.49.2</span> 方案</h3>
<p>有许多检验方差同质性的方式，下面列出三种：</p>
<ul>
<li><strong>Bartlett’s test</strong> - 如果数据服从正态分布，这是最好地检验方法。该方法对非正态数据非常敏感，如果数据不是正态的很可能返回假阳性的结果。</li>
<li><strong>Levene’s test</strong> - 数据偏离正态性时比Bartlett检验更稳定（鲁棒性更好），内置于<code>car</code>包</li>
<li><strong>Fligner-Killeen test</strong> - 这是一个非参数检验，数据偏离正态是非常稳定适用。</li>
</ul>
<p>对于所有的检验，零假设为总体方差相同（同质；<strong>不是相等的意思</strong>）；备择假设是至少两组样本（总体方差）不同。</p>
<div id="-1" class="section level4">
<h4><span class="header-section-number">0.49.2.1</span> 样例数据</h4>
<p>这里的例子使用了<code>InsectSprays</code> 和 <code>ToothGrowth</code> 数据集。 <code>InsectSprays</code> 数据集有一个独立变量，而 <code>ToothGrowth</code> 数据集有两个独立变量。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(InsectSprays)
<span class="co">#&gt;   count spray</span>
<span class="co">#&gt; 1    10     A</span>
<span class="co">#&gt; 2     7     A</span>
<span class="co">#&gt; 3    20     A</span>
<span class="co">#&gt; 4    14     A</span>
<span class="co">#&gt; 5    14     A</span>
<span class="co">#&gt; 6    12     A</span>

tg      &lt;-<span class="st"> </span>ToothGrowth
tg<span class="op">$</span>dose &lt;-<span class="st"> </span><span class="kw">factor</span>(tg<span class="op">$</span>dose) <span class="co"># Treat this column as a factor, not numeric</span>
<span class="kw">head</span>(tg)
<span class="co">#&gt;    len supp dose</span>
<span class="co">#&gt; 1  4.2   VC  0.5</span>
<span class="co">#&gt; 2 11.5   VC  0.5</span>
<span class="co">#&gt; 3  7.3   VC  0.5</span>
<span class="co">#&gt; 4  5.8   VC  0.5</span>
<span class="co">#&gt; 5  6.4   VC  0.5</span>
<span class="co">#&gt; 6 10.0   VC  0.5</span></code></pre></div>
<p>快速绘制数据集的箱线图：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data =</span> InsectSprays)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(len <span class="op">~</span><span class="st"> </span><span class="kw">interaction</span>(dose,supp), <span class="dt">data=</span>ToothGrowth)</code></pre></div>
<p>初一看好像数据集的方差都不同质，但这需要像下面一样进行合适的检验。</p>
</div>
<div id="bartletts-test" class="section level4">
<h4><span class="header-section-number">0.49.2.2</span> Bartlett’s test</h4>
<p>有一个独立变量：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bartlett.test</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data=</span>InsectSprays)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Bartlett test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  count by spray</span>
<span class="co">#&gt; Bartlett&#39;s K-squared = 25.96, df = 5, p-value = 9.085e-05</span>

<span class="co"># Same effect, but with two vectors, instead of two columns from a data frame</span>
<span class="co"># bartlett.test(InsectSprays$count ~ InsectSprays$spray)</span></code></pre></div>
<p>有多个独立变量，必须使用<code>interaction()</code>函数将这些独立变量包裹为含所有因子组合的单个变量。如果不适应，那么会得到错误的自由度，因而p值也将是错误的。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bartlett.test</span>(len <span class="op">~</span><span class="st"> </span><span class="kw">interaction</span>(supp,dose), <span class="dt">data=</span>ToothGrowth)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Bartlett test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  len by interaction(supp, dose)</span>
<span class="co">#&gt; Bartlett&#39;s K-squared = 6.9273, df = 5, p-value = 0.2261</span>

<span class="co"># The above gives the same result as testing len vs. dose alone, without supp</span>
<span class="kw">bartlett.test</span>(len <span class="op">~</span><span class="st"> </span>dose, <span class="dt">data=</span>ToothGrowth)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Bartlett test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  len by dose</span>
<span class="co">#&gt; Bartlett&#39;s K-squared = 0.66547, df = 2, p-value = 0.717</span></code></pre></div>
</div>
<div id="levenes-test" class="section level4">
<h4><span class="header-section-number">0.49.2.3</span> Levene’s test</h4>
<p><code>leveneTest</code> 函数是<code>car</code> 包的一部分。</p>
<p>有一个独立变量：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)

<span class="kw">leveneTest</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data=</span>InsectSprays)
<span class="co">#&gt; Levene&#39;s Test for Homogeneity of Variance (center = median)</span>
<span class="co">#&gt;       Df F value   Pr(&gt;F)   </span>
<span class="co">#&gt; group  5  3.8214 0.004223 **</span>
<span class="co">#&gt;       66                    </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></code></pre></div>
<p>有两个独立变量。注意这里 <code>interaction</code>函数不需要，因为该函数用于其他两个检验。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">leveneTest</span>(len <span class="op">~</span><span class="st"> </span>supp<span class="op">*</span>dose, <span class="dt">data=</span>tg)
<span class="co">#&gt; Levene&#39;s Test for Homogeneity of Variance (center = median)</span>
<span class="co">#&gt;       Df F value Pr(&gt;F)</span>
<span class="co">#&gt; group  5  1.7086 0.1484</span>
<span class="co">#&gt;       54</span></code></pre></div>
</div>
<div id="fligner-killeen-test" class="section level4">
<h4><span class="header-section-number">0.49.2.4</span> Fligner-Killeen test</h4>
<p>有一个独立变量：</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fligner.test</span>(count <span class="op">~</span><span class="st"> </span>spray, <span class="dt">data=</span>InsectSprays)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fligner-Killeen test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  count by spray</span>
<span class="co">#&gt; Fligner-Killeen:med chi-squared = 14.483, df = 5, p-value = 0.01282</span>

<span class="co"># Same effect, but with two vectors, instead of two columns from a data frame</span>
<span class="co"># fligner.test(InsectSprays$count ~ InsectSprays$spray)</span></code></pre></div>
<p>当处理多个独立变量时，这个<code>fligner.test</code> 函数有跟<code>bartlett.test</code>相同的行为。必须使用 <code>interaction()</code> 函数。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fligner.test</span>(len <span class="op">~</span><span class="st"> </span><span class="kw">interaction</span>(supp,dose), <span class="dt">data=</span>ToothGrowth)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fligner-Killeen test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  len by interaction(supp, dose)</span>
<span class="co">#&gt; Fligner-Killeen:med chi-squared = 7.7488, df = 5, p-value = 0.1706</span>


<span class="co"># The above gives the same result as testing len vs. dose alone, without supp</span>
<span class="kw">fligner.test</span>(len <span class="op">~</span><span class="st"> </span>dose, <span class="dt">data=</span>ToothGrowth)
<span class="co">#&gt; </span>
<span class="co">#&gt;  Fligner-Killeen test of homogeneity of variances</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  len by dose</span>
<span class="co">#&gt; Fligner-Killeen:med chi-squared = 1.3879, df = 2, p-value = 0.4996</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="e6938de4bd9ce695b0e68dae.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="e59bbee5bda2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/openbiox/Cookbook-for-R-Chinese/edit/master/book/07-stats.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
